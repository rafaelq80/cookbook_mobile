<h1>Projeto 02 - Todo-List - Classes TarefaController e TarefaService - M√©todo Listar Tudo</h1>

O que veremos por aqui:

1. Criar a Classe TarefaService
2. Criar a Classe TarefaController
3. Criar o M√©todo findAll() para listar todas as Tarefas
4. Registrar as 2 Classes no M√≥dulo TarefaModule
5. Registrar o M√≥dulo TarefaModule no M√≥dulo APPModule
6. Testar o M√©todo findAll() no Insomnia

<h2>1. O M√≥dulo Tarefa</h2>

Na etapa anterior, come√ßamos a construir o **M√≥dulo Tarefa**, a partir da **Classe Entidade (Model) Tarefa**, onde implementamos todos os Atributos do recurso Tarefa e geramos a tabela **tb_tarefas** dentro do nosso Banco de dados **db_todolist**. Agora vamos come√ßar a criar os M√©todos do CRUD do recurso Tarefa, listados no Diagrama de Classes abaixo, nas Classes **TarefaService** e **TarefaController**.

```mermaid
classDiagram
class Tarefa {
  - id : number
  - nome : string
  - descricao: string
  - responsavel: string
  - data: Date
  - status: boolean
  - categoria: Categoria
  + findAll()
  + findById(id : number)
  + findByNome(nome : string)
  + create(categoria : Categoria)
  + update(categoria : Categoria)
  + delete(id : number)
}
```

Ser√£o implementados 6 M√©todos: 

- 3 M√©todos de Busca (GET)
- 1 M√©todo de Persist√™ncia dos Objetos no Banco de dados (POST)
- 1 M√©todo de Atualiza√ß√£o dos Objetos persistidos no Banco de dados (PUT)
- 1 M√©todo para apagar Objetos persistidos no Banco de dados (DELETE)

A Classe **TarefaService** ser√° a Classe de Servi√ßo do M√≥dulo Tarefa, ou seja, onde implementaremos os M√©todos com as regras de neg√≥cio da aplica√ß√£o. A Classe **TarefaController** ser√° a Classe Controladora do M√≥dulo Tarefa, ou seja, onde implementaremos os M√©todos respons√°veis por responder toda e qualquer Requisi√ß√£o (HTTP Request), que for enviada de fora da aplica√ß√£o para o recurso Tarefa. 

> **Regras de neg√≥cio:**  O termo regras de neg√≥cio refere-se √†s **diretrizes que definem ou restringem as a√ß√µes, mostrando como os M√©todos devem funcionar, o que deve ser checado em cada M√©todo e quais s√£o os limites da aplica√ß√£o**. Essas regras s√£o importantes para que a pessoa desenvolvedora tenha uma vis√£o clara do que deve ser feito, como e por qual raz√£o.

N√≥s iremos implementar os M√©todos do **CRUD** nas duas Classes, com os mesmos nomes, mas com responsabilidades diferentes. O M√©todo da Classe de Servi√ßo far√° o processamento dos dados enviados na Requisi√ß√£o, enquanto O M√©todo da Classe Controladora receber√° as Requisi√ß√µes e enviar√° os dados para a Classe de Servi√ßo. Ap√≥s a conclus√£o do processamento da Requisi√ß√£o, A Classe Controladora enviar√° uma Resposta HTTP, definida a partir do retorno do M√©todo da Classe de Servi√ßo, al√©m do resultado do processamento do M√©todo da Classe de Servi√ßo. 

<h2>üë£ Passo 01 - Criar a Classe TarefaService</h2>

Vamos criar a pasta **services**, dentro do nosso **M√≥dulo Tarefa** (pasta Tarefa):

1. Na pasta **Tarefa**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

<div align="center"><img src="https://i.imgur.com/mcD3zCu.png" title="source: imgur.com" /></div>

2. O nome da pasta ser√° **services**, como mostra a figura abaixo. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/A6IZL09.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar a pasta services. Um erro muito comum √© criar a pasta services fora da pasta da pasta tarefa.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

Na sequ√™ncia, vamos criar a Classe de Servi√ßo **TarefaService** que chamaremos de **tarefa.service.ts**

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe de Servi√ßo. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest (nome_do_modulo.tipo_da_classe.ts) para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Clique com o bot√£o direito do mouse sobre a **pasta services**, que foi criada dentro da pasta **tarefa**, como mostra a figura abaixo, e na sequ√™ncia clique na op√ß√£o **New File** (Novo Arquivo).

<div align="center"><img src="https://i.imgur.com/lTbrwvM.png" title="source: imgur.com" /></div>

2. O nome do arquivo ser√° **tarefa.service.ts**, como mostra a figura abaixo. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/KfZcpNC.png" title="source: imgur.com" /></div>

Agora vamos come√ßar a criar o c√≥digo da Classe **TarefaService**, como mostra a figura abaixo. Como iremos construir 6 M√©todos dentro da Classe de Servi√ßo, vamos construir por partes. Aqui construiremos apenas o primeiro M√©todo (**findAll()**), que tem como objetivo listar todas as Tarefas persistidas no Banco de dados.

<div align="center"><img src="https://i.imgur.com/AHC37ax.png?1" title="source: imgur.com" width="90%"/></div>

Vamos analisar o c√≥digo:

**Linha 1:** Importamos o pacote **Common** com os respectivos **decorators**, utilizados na implementa√ß√£o da Classe TarefaService.

**Linha 2:** Importamos o pacote **TypeORM** com os respectivos **decorators**, utilizados na implementa√ß√£o da Classe TarefaService.

**Linha 3:** Importamos a Classe **Repository**, do M√≥dulo **typeorm**, do pacote **Typeorm**. 

**Linha 4:** Importamos a Classe Entidade **Tarefa**, do M√≥dulo **Tarefa**.

**Linha 6:** O decorator **@Injectable** indica que a Classe √© do tipo Service (Classe de Servi√ßo), que pode ser Injetada em outras Classes atrav√©s da **Inje√ß√£o de Depend√™ncias**.

**Linha 9:** Cria um **Construtor**, que receber√° as **Inje√ß√µes de Depend√™ncia** necess√°rias para o desenvolvimento da Classe de Servi√ßo.

**Linhas 10:** O decorator **@InjectRepository(Tarefa)** √© a  implementa√ß√£o utilizada pelo TypeORM para  aplicar  a  **Invers√£o  de  Controle (IoC)**, sempre que for necess√°rio. A Inje√ß√£o de Depend√™ncia define quais Classes ser√£o instanciadas automaticamente e em quais lugares ser√£o "Injetadas" quando houver necessidade.

> **Invers√£o de controle:** ou IOC √© um princ√≠pio de design de programas de computadores, onde a sequ√™ncia de chamadas dos  M√©todos √© invertida em rela√ß√£o √† programa√ß√£o tradicional, ou seja, ela  n√£o √© determinada diretamente pelo programador e sim pela Linguagem ou Framework. √â a transfer√™ncia da responsabilidade de Criar e Instanciar Objetos para a Linguagem ou Framework. A Inje√ß√£o de Depend√™ncias √© um tipo de Invers√£o de Controle.

Em nosso exemplo, a Classe de Servi√ßo cria um ponto de inje√ß√£o do tipo **Tarefa** e quando houver a necessidade o TypeORM cria um novo **Objeto da Classe Tarefa** atrav√©s da Interface **Repository**. A grande vantagem de se utilizar a Inje√ß√£o de Depend√™ncias √© que voc√™ consegue instanciar e acessar os Objetos sem a necessidade de criar M√©todos Construtores na Classe Entidade ou criar/instanciar Objetos de forma manual, semelhante ao que era feito nas Sess√µes de Programa√ß√£o Orientada √† Objetos. Estamos transferindo esta responsabilidade para o TypeORM e desta forma nos preocuparemos apenas com o processamento das Requisi√ß√µes HTTP.

> A Interface **Repository** nos auxilia na intera√ß√£o com o Banco de dados. Esta Interface cont√©m diversos  M√©todos pr√©-implementados para a manipula√ß√£o dos dados de uma Entidade, como os M√©todos para salvar, deletar, listar e alterar dados dos objetos persistidos no Banco de dados (CRUD). Outra vantagem da Interface Repository √© que os M√©todos de consulta permitem criar qualquer consulta SQL que voc√™ precisar, de forma simples e r√°pida.

**Linha 11:** Definimos o nome do Objeto da Interface **Repository** (**TarefaRepository**), que ser√° respons√°vel por implementar a **Inje√ß√£o de Depend√™ncias** e executar os M√©todos da Interface Repository.

**Linha 14:** Criamos o M√©todo Ass√≠ncrono (async), chamado **findAll()**, que promete retornar uma **Promise** contendo um array de Objetos da Classe Tarefa. Como o M√©todo findAll() lista v√°rios Objetos √© necess√°rio criar um array para armazenar todos os Objetos.

**Linha 15:** Retorna a execu√ß√£o do M√©todo **find()**, da Interface **TarefaRepository**. Tra√ßando um paralelo com o MySQL, o M√©todo find() sem par√¢metros seria o equivalente a instru√ß√£o: <code>SELECT * FROM tb_tarefas;</code>, que lista todas as Tarefas da Tabela tb_tarefas. Observe que na instru√ß√£o **return** foi inserido o comando **await** (aguarde), que na pr√°tica significa espere que a **Promise** seja resolvida (os Objetos Tarefa sejam inseridos no array de Objetos Tarefa da Promise), antes de retornar a execu√ß√£o do M√©todo e o valor resolvido para a Classe que acionou o M√©todo.

> **Promise:** √â um objeto usado para processamento ass√≠ncrono. Uma Promise na pr√°tica √© uma promessa, que representa um valor que pode estar dispon√≠vel agora, no futuro ou nunca. Uma Promise √© como um "procurador" para um valor que n√£o √© necessariamente conhecido quando a promessa √© criada. Isso permite a associa√ß√£o de M√©todos de tratamento para eventos da a√ß√£o ass√≠ncrona num caso eventual de sucesso ou de falha. Isto permite que os M√©todos ass√≠ncronos retornem valores como M√©todos s√≠ncronos: ao inv√©s do valor final, o M√©todo ass√≠ncrono retorna uma *promessa* ao valor em algum momento no futuro.
>
> Uma Promise pode ter 3 estados: 
>
> - *pending* (pendente): Estado inicial, que n√£o foi realizada nem rejeitada.
> - *fulfilled* (resolvida): sucesso na opera√ß√£o.
> - *rejected* (rejeitado):  falha na opera√ß√£o.

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores Customizados - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database" target="_blank"><b>Documenta√ß√£o: <i>Interface Reposit√≥rio</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/working-with-repository" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Reposit√≥rios</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/find-options" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - M√©todo de busca find()</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documenta√ß√£o: Promise</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/async_function" target="_blank"><b>Documenta√ß√£o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documenta√ß√£o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/04_Listar_Tarefas/todolist/src/tarefa/services/tarefa.service.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaService</b></a>


<br />

<h2>üë£ Passo 02 - Criar a Classe TarefaController</h2>

Vamos criar a pasta **controllers**, dentro do nosso **M√≥dulo Tarefa** (pasta Tarefa):

1. Na pasta **tarefa**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

<div align="center"><img src="https://i.imgur.com/mcD3zCu.png" title="source: imgur.com" /></div>

2. O nome da pasta ser√° **controllers**, como mostra a figura abaixo. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/eBaBIRH.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar a pasta controllers. Um erro muito comum √© criar a pasta controllers fora da pasta tarefa.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

Na sequ√™ncia, vamos criar a Classe Controladora **TarefaController** que chamaremos de **tarefa.controller.ts**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe de Servi√ßo. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest (nome_do_modulo.tipo_da_classe.ts) para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Clique com o bot√£o direito do mouse sobre a **pasta controllers**, que foi criada dentro da pasta **tarefa**, como mostra a figura abaixo, e clique na op√ß√£o **New File** (Novo Arquivo).

<div align="center"><img src="https://i.imgur.com/CzaGBYh.png" title="source: imgur.com" /></div>

2. O nome do arquivo ser√° **tarefa.controller.ts**, como mostra a figura abaixo. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/4PV6We4.png" title="source: imgur.com" /></div>

Agora vamos come√ßar a criar o c√≥digo da Classe **TarefaController**, como mostra a figura abaixo. Como iremos construir 6 M√©todos dentro da Classe Controladora, vamos construir por partes. Aqui construiremos apenas o primeiro M√©todo, o **findAll()**, que tem como objetivo executar o M√©todo com o mesmo nome na **Classe TarefaService**.

<div align="left"><img src="https://i.imgur.com/KAkme2i.png?1" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo:

**Linha 1:** Importamos o pacote **Common** com os respectivos **decorators**, utilizados na implementa√ß√£o da Classe TarefaController.

**Linha 2:** Importamos a Classe **Tarefa**, do M√≥dulo **Tarefa**.

**Linha 3:** Importamos a Classe **TarefaService**, do M√≥dulo **Tarefa**.

**Linha 5:** O decorator **@Controller** indica que a Classe √© do tipo **RestController**, que receber√° requisi√ß√µes que ser√£o compostas por:

- **URL:** Endere√ßo da Requisi√ß√£o (**endpoint**)
- **Verbo:** Define qual M√©todo HTTP ser√° acionado na Classe controladora.
- **Corpo da Requisi√ß√£o (Request Body):** Objeto que cont√©m os dados que ser√£o persistidos no Banco de dados. Apenas as Requisi√ß√µes do tipo POST e PUT conseguem enviar dados no Corpo da Requisi√ß√£o.

Ap√≥s receber e processar a Requisi√ß√£o, a Classe Controladora Responder√° com:

- Um **C√≥digo de Status HTTP** pertinente a opera√ß√£o que est√° sendo realizada.
- O resultado do processamento (Objetos de uma Classe, por exemplo) inserido diretamente no corpo da resposta (**Response Body**)

O par√¢metro inserido dentro dos par√™nteses √© usado para mapear as solicita√ß√µes para os M√©todos da Classe controladora **TarefaController**, ou seja, definir a **URL** (endere√ßo) padr√£o do M√≥dulo (**/tarefas**). Ao digitar a URL do servidor seguida do caminho do Recurso (**http://localhost:4000/tarefas**), a Classe Controladora enviar√° a Requisi√ß√£o para a Classe associada √† este endere√ßo (TarefaController) e o Respectivo M√©todo, de acordo com o caminho e o verbo HTTP (GET, POST, PUT ou DELETE).

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao configurar a URL do M√≥dulo. Observe que configuramos a URL (/tarefas) iniciando com uma barra, com letras min√∫sculas, usando o mesmo nome do m√≥dulo no plural, sem acentos, caracteres especiais e espa√ßos em branco. Lembre-se que todos os endere√ßos na WEB seguem este padr√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 7:** Cria um Construtor, que receber√° as Inje√ß√µes de Depend√™ncia. Como precisaremos ter acesso aos M√©todos da **Classe TarefaService**, foi injetado um Objeto desta Classe dentro do Construtor.

**Linha 9:** O decorator **@Get()** mapeia todas as Requisi√ß√µes **HTTP GET**, enviadas para um endere√ßo espec√≠fico, chamado **endpoint**, dentro do M√≥dulo Tarefa, para um M√©todo espec√≠fico que responder√° a Requisi√ß√£o, ou seja, ele indica que o M√©todo **findAll()**, responder√° a todas as requisi√ß√µes do tipo **HTTP GET**, enviadas no endere√ßo **http://localhost:4000/tarefas/**.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ATEN√á√ÉO:** *O Endere√ßo do endpoint ser√° igual ao Endere√ßo do M√≥dulo apenas quando o decorator @Get() n√£o possuir um endere√ßo personalizado, como um par√¢metro por exemplo. Caso existam dois ou mais M√©todos do tipo GET ser√° necess√°rio personalizar o endere√ßo de cada M√©todo anotado com @Get("/endereco").* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 10:** O decorator **@HttpCode(HttpStatus.OK)** indica que o M√©todo **findAll()**, ter√° como **Resposta HTTP** padr√£o o HTTP Status **OK ü°™ 200**, ou seja, quando a Resposta da Requisi√ß√£o for positiva, ser√° retornado o **HTTP Status OK ü°™ 200**. Caso a Resposta seja negativa (algo deu errado), a Resposta depender√° do erro.

**Linha 11:** Criamos o M√©todo **findAll()**, que promete retornar uma **Promise** (que ser√° enviada pela Classe TarefaService), contendo um array de Objetos Tarefa. 

**Linha 12:** Executa o M√©todo **findAll()** (**M√©todo da Classe TarefaService**), que retornar√° **todos os Objetos da Classe Tarefa** persistidos no Banco de dados dentro de um array. 

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documenta√ß√£o: HTTP Request Methods</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documenta√ß√£o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers" target="_blank"><b>Documenta√ß√£o: <i>Classe Controladora</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe Controladora</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/04_Listar_Tarefas/todolist/src/tarefa/controllers/tarefa.controller.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaController</b></a>

<br />

<h2>üë£ Passo 03 - Registrar as Classes TarefaService e TarefaController na Classe TarefaModule</h2>

Na sequ√™ncia, vamos registrar as nossas duas Classes (**TarefaService** e **TarefaController**), no M√≥dulo **TarefaModule**. Esse passo √© fundamental para o correto funcionamento da nossa aplica√ß√£o.

1. Abra a Classe **TarefaModule**, localizada na pasta **tarefa**, conforme indicada na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/0RSxTAb.png" title="source: imgur.com" /></div>

2. Implemente as altera√ß√µes, indicadas pelas setas na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/oD9snW1.png?1" title="source: imgur.com" /></div>

Vamos analisar as altera√ß√µes no c√≥digo:

**Linha 1:** Importamos a Classe **TarefaController**, criada anteriormente. 

**Linha 2:** Importamos a Classe **TarefaService**, criada anteriormente. 

**Linha 9:** No array **providers** vamos adicionar a **Classe TarefaService** do **M√≥dulo Tarefa**. Desta forma a Classe de Servi√ßo poder√° ser injetada em outras Classes dentro do M√≥dulo.

**Linha 10:** No array **controllers** vamos adicionar a **Classe TarefaController** do **M√≥dulo Tarefa**. Desta forma os endpoints da Classe Controladora estr√£o dispon√≠veis para receber Requisi√ß√µes HTTP.

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/04_Listar_Tarefas/todolist/src/tarefa/tarefa.module.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaModule</b></a></div>

<br />

<h2>üë£ Passo 04 - Registrar o M√≥dulo TarefaModule no M√≥dulo AppModule</h2>

Para finalizar, vamos registrar a Classe **Tarefa** no M√≥dulo principal da  aplica√ß√£o, a Classe **AppModule**. 

1. Abra a Classe **AppModule**, localizada na pasta **src**, conforme indicada na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/atwci1S.png" title="source: imgur.com" /></div>

2. Implemente as duas altera√ß√µes, indicadas pelas setas na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/dqsxhvx.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo:

**Linha 1:** Importamos o M√≥dulo **TarefaModule**.

**Linha 18:** No array **imports** vamos inserir o M√≥dulo **TarefaModule**.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *Se o M√≥dulo TarefaModule, n√£o for registrado no M√≥dulo principal da aplica√ß√£o (AppModule), os endpoints da aplica√ß√£o n√£o ficar√£o dispon√≠veis para serem consumidos pelo front-end.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/04_Listar_Tarefas/todolist/src/app.module.ts" target="_blank"><b>C√≥digo fonte da Classe AppModule</b></a></div>

<br />

<h2>üë£ Passo 05 - Executar o projeto</h2>

1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/kXggbYz.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **todolist**. 

```bash
npm run start:dev
```

3. Se tudo deu certo, o resultado ser√° semelhante ao da figura abaixo:

<div align="center"><img src="https://i.imgur.com/Nsn2F6X.png" title="source: imgur.com" /></div>

4. Observe na imagem acima, na regi√£o destacada em amarelo, que o endpoint do tipo **GET** , apontando para o caminho (rota) **/tarefas**, foi disponibilizado (mapeado).

<br />

<h2>üë£ Passo 06 - Inserir dados no Banco de dados</h2>

Como ainda n√£o criamos um M√©todo para Cadastrar Tarefas (criaremos em breve), vamos inserir dois registros diretamente no Banco de Dados **db_todolist**  na Tabela **tb_tarefas** para testarmos o nosso M√©todo **findAll()**.

1. Abra o <b>MySQL Workbench</b>.

1. Crie um novo arquivo SQL **(SQLFile)** e digite os comandos abaixo:


```sql
USE db_todolist;

INSERT INTO tb_tarefas(nome, descricao, responsavel, data, status)
VALUES ("Tarefa 01", "Descri√ß√£o da Tarefa 01", "Respons√°vel 01", "2022-07-22", true);

INSERT INTO tb_tarefas(nome, descricao, responsavel, data, status)
VALUES ("Tarefa 02", "Descri√ß√£o da Tarefa 02", "Respons√°vel 02", "2022-07-23", false);

SELECT * FROM tb_Tarefas;
```

3. Selecione todas as linhas e clique no primeiro raio <img src="https://i.imgur.com/xH6Ei9O.png" title="source: imgur.com" /> para inserir os dados na tabela **tb_tarefas**.

<div align="center"><img src="https://i.imgur.com/jI3x0FI.png" title="source: imgur.com" /></div>

4. A imagem acima mostra que os dados foram inseridos com sucesso!

<br />

<h2>üë£ Passo 07 - Testar no Insomnia</h2>

Para testar a aplica√ß√£o, utilizaremos o **Insomnia**. 

Para organizar os nossos testes, vamos criar uma **Collection** para guardar todas as nossas **Requisi√ß√µes do Projeto Todo-List**. Na sequ√™ncia vamos criar dentro da Collection uma pasta chamada **Tarefa** para guardar todas as requisi√ß√µes do M√≥dulo Tarefa. Para concluir, vamos criar uma Requisi√ß√£o do tipo **GET**, dentro da pasta Tarefa, para testar o nosso M√©todo **findAll()**.

<h3>7.1. Criando a Collection Todo-List</h3>

1. Na janela principal do **Insomnia**, clique no bot√£o **Create** e clique na op√ß√£o **Request Collection**.

<div align="center"><img src="https://i.imgur.com/OzaorsG.png" title="source: imgur.com" /></div>

2. Na janela que ser√° aberta, informe o nome da Collection (**Todo-List**) e clique no bot√£o **Create** para concluir. 

<div align="center"><img src="https://i.imgur.com/F9waEFV.png" title="source: imgur.com" /></div>

<h3>7.2. Criando a  Pasta Tarefa</h3>

Vamos criar dentro da **Collection Todo-List**, na **Pasta Tarefa**, que guardar√° todas as requisi√ß√µes do **M√≥dulo Tarefa**.

1. Na **Collection Todo-List**, clique no bot√£o <img src="https://i.imgur.com/Igkx9ev.png" title="source: imgur.com" width="25px"/>. No menu que ser√° aberto, clique na op√ß√£o **New Folder**.

<div align="center"><img src="https://i.imgur.com/cMy0hfU.png" title="source: imgur.com" /></div>

2. Na janela que ser√° aberta, informe o nome da pasta (**Tarefa**) e clique no bot√£o **Create** para concluir. 

<div align="center"><img src="https://i.imgur.com/hzpK0YZ.png" title="source: imgur.com" /></div>

<h3>7.3. Criando a  Requisi√ß√£o - Consultar todas as Tarefas - findAll()</h3>

Agora vamos criar a Requisi√ß√£o para o **M√©todo findAll()**:

1. Clique com o bot√£o direito do mouse sobre a **Pasta Tarefa** para abrir o menu e clique na op√ß√£o **New Request**.

<div align="center"><img src="https://i.imgur.com/6CwyPRd.png?1" title="source: imgur.com" /></div>

2. Ser√° criada uma nova Requisi√ß√£o (New Request) dentro da pasta **Tarefa**.

<div align="center"><img src="https://i.imgur.com/7pjtaFW.png?1" title="source: imgur.com" /></div>

3. D√™ um duplo clique sobre a nova Requisi√ß√£o (**New Request**), informe o nome da Requisi√ß√£o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/NINYoSV.png" title="source: imgur.com" /></div>

4. Selecione o M√©todo HTTP que ser√° utilizado (**GET**) na Requisi√ß√£o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/mWPpKHD.png" title="source: imgur.com" /></div>

5. Configure o endere√ßo da Requisi√ß√£o conforme a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/NXrdnR4.png" title="source: imgur.com" /></div>

6. No item marcado em amarelo na imagem acima, informe o endere√ßo do endpoint da Requisi√ß√£o. A Requisi√ß√£o **Consultar Todas as Tarefas** foi configurada da seguinte maneira:

- A primeira parte do endere√ßo (http://localhost:4000) √© o endere√ßo do nosso servidor local. Quando a aplica√ß√£o estiver na nuvem, ele ser√° substitu√≠do pelo endere√ßo da nuvem (**Exemplo:** http://nomedaaplicacao.herokuapp.com).
- A segunda parte do endere√ßo √© o **endpoint** configurado no decorator ***@Controller()***, em nosso caso  **/tarefas**. 

7. Para testar a Requisi√ß√£o, com a aplica√ß√£o rodando, clique no bot√£o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="60px"/>.

8. O resultado da Requisi√ß√£o voc√™ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/mnjNigu.png" title="source: imgur.com" /></div>

9. Observe que a aplica√ß√£o al√©m de exibir os dados de todos os Objetos da Classe Tarefa persistidos no Banco de dados, no Corpo da Resposta. Ela tamb√©m retornar√° um **HTTP Status 200 ü°™ OK** (indicado em verde na imagem acima), informando que a Requisi√ß√£o foi bem sucedida!

<div align="left"><img src="https://i.imgur.com/g1HCNZy.png" title="source: imgur.com" width="30px" /><a href="https://docs.insomnia.rest/" target="_blank"><b>Documenta√ß√£o: Insomnia Rest</b></a></div>

<div align="left"><img src="https://i.imgur.com/muiNdkC.png" title="source: imgur.com" width="25px"/><a href="https://www.json.org/json-pt.html" target="_blank"><b>Documenta√ß√£o: Padr√£o JSON</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/tree/04_Listar_Tarefas" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>