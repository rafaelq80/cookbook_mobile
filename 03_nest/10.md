<h1>Projeto 02 - Todo-List - Classe TarefaController e TarefaService - M√©todos Cadastrar e Atualizar</h1>

O que veremos por aqui:

1. Criar o M√©todo create(tarefa: Tarefa) na Classe TarefaService
2. Criar o M√©todo create(tarefa: Tarefa) na Classe TarefaController
3. Criar o M√©todo update(tarefa: Tarefa) na Classe TarefaService
4. Criar o M√©todo update(tarefa: Tarefa) na Classe TarefaController
5. Testar os M√©todos no Insomnia

<h2>1. O M√≥dulo Tarefa</h2>

Nas etapas anteriores, come√ßamos a construir as Classes **TarefaService** e **TarefaController** e implementamos os seguintes M√©todos:

-  **findAll()**  ü°™ Retorna todos os Objetos da Classe Tarefa persistidos no Banco de dados.
-  **findById(id: number)** ü°™ Retorna um Objeto espec√≠fico da Classe Tarefa persistido no Banco de dados. A Tarefa √© identificada pelo Atributo id. 
-  **findByNome(nome: string)** ü°™ Retorna  todos os Objetos da Classe Tarefa persistidos no Banco de dados, cujo Atributo nome contenha (em qualquer parte) a String enviada no par√¢metro nome do M√©todo.   

Vamos continuar a constru√ß√£o das Classes **TarefaService** e **TarefaController** implementando os M√©todos **create(tarefa: Tarefa)**, que persistir√° um novo Objeto da Classe Tarefa no Banco de dados e  **update(tarefa: Tarefa)**, que atualizar√° um Objeto da Classe Tarefa persistido no Banco de dados.

```mermaid
classDiagram
class Tarefa {
  - id : number
  - nome : string
  - descricao: string
  - responsavel: string
  - data: Date
  - status: boolean
  - categoria: Categoria
  + findAll()
  + findById(id : number)
  + findByDescricao(descricao : string)
  + create(categoria : Categoria)
  + update(categoria : Categoria)
  + delete(id : number)
}
```

<h2>üë£ Passo 01 - Criar o M√©todo create(tarefa: Tarefa) na Classe TarefaService</h2>

Vamos implementar o M√©todo **create(tarefa: Tarefa)** na Classe TarefaService. Tra√ßando um paralelo com o MySQL, seria o equivalente a instru√ß√£o: <code>INSERT INTO tb_tarefas(nome, descricao, responsavel, data, status)
VALUES ("Tarefa", "Descri√ß√£o da Tarefa", "Respons√°vel", "2022-07-22", true);</code>.

1. Abra a Classe **Tarefa Service**, localizada na pasta **src/tarefa/services**.

<div align="center"><img src="https://i.imgur.com/KfZcpNC.png" title="source: imgur.com" /></div>

2. Insira o c√≥digo abaixo depois do M√©todo **findByNome(nome: string)**.

<div align="left"><img src="https://i.imgur.com/pDufNkZ.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo do M√©todo:

**Linha 39:** Criamos o M√©todo Ass√≠ncrono (async), chamado **create(tarefa: Tarefa)**, que promete retornar uma **Promise** contendo um Objeto da Classe Tarefa, que foi persistido no Banco de dados da aplica√ß√£o. 

Observe que o M√©todo **create(tarefa: Tarefa)** possui um par√¢metro do tipo **Tarefa**, chamado **tarefa**. Esta vari√°vel receber√° um Objeto da Classe Tarefa, que foi enviado no Corpo da Requisi√ß√£o (Request Body), conforme as regras definidas na Entidade Tarefa (Tamanho, Pode ser Nulo, Pode ser vazio, entre outras). O Objeto tarefa ser√° enviado pelo M√©todo da **Classe TarefaController**, atrav√©s de um **JSON**, semelhante ao exemplo abaixo: 

```json
{
    "nome" : "Tarefa 03",
    "descricao" :"Descri√ß√£o da Tarefa 03",
    "responsavel" : "Respons√°vel 03",
    "data" : "2022-07-25",
    "status" : true
}
```

Observe que o Atributo **id n√£o ser√° informado porqu√™ ser√° atribu√≠do pelo Banco de dados** ap√≥s o Objeto ser persistido no Banco de dados.

**Linha 40:** Retorna a execu√ß√£o do M√©todo **save()**, da Interface **tarefaRepository**. O resultado da execu√ß√£o do M√©todo **save()**, ser√° um Objeto da Classe Tarefa persistido (salvo) no Banco de dados, na tabela **tb_tarefas**.  

Observe que na instru√ß√£o **return** foi inserido o comando **await** (aguarde), que na pr√°tica significa espere que a **Promise** seja resolvida (o Objeto Tarefa seja persistido), antes de retornar a execu√ß√£o do M√©todo e o valor resolvido para a Classe que acionou o M√©todo.

No caso de uma persist√™ncia dos dados, o retorno esperado do M√©todo **save()** ser√° a confirma√ß√£o do Objeto persistido, no formato JSON, como mostra o exemplo abaixo:

```json
{
    "id" : 3,
	"nome": "Tarefa 03",
	"descricao": "Descri√ß√£o da Tarefa 03",
	"responsavel": "Respons√°vel 03",
	"data": "2022-07-25",
	"status": true
}
```

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores Customizados - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/find-options" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - M√©todo de busca find()</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documenta√ß√£o: Promise</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/async_function" target="_blank"><b>Documenta√ß√£o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documenta√ß√£o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/services/tarefa.service.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaService</b></a></div>

<br /><br />


<h2>üë£ Passo 02 - Criar o M√©todo create(tarefa: Tarefa) na Classe TarefaController</h2>

Vamos implementar o M√©todo **create(@Body() tarefa: Tarefa)** na Classe TarefaController, que tem como objetivo executar o M√©todo com o mesmo nome na Classe de Servi√ßo TarefaService. 

1. Abra a Classe **TarefaController**, localizada na pasta **src/tarefa/controllers**.

<div align="center"><img src="https://i.imgur.com/4PV6We4.png" title="source: imgur.com" /></div>

2. Insira o c√≥digo depois do M√©todo **findByNome(nome: string)**.

<div align="left"><img src="https://i.imgur.com/vzclSNN.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo do M√©todo:

**Linha 27:** O decorator **@Post()** mapeia todas as Requisi√ß√µes **HTTP POST**, enviadas para um endere√ßo espec√≠fico, chamado **endpoint**, dentro do M√≥dulo Tarefa, para um M√©todo espec√≠fico que responder√° a Requisi√ß√£o, ou seja, ele indica que o M√©todo **create(@Body() tarefa: Tarefa)**, responder√° a todas as requisi√ß√µes do tipo **HTTP POST**, enviadas no endere√ßo **http://localhost:4000/tarefas/**.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ATEN√á√ÉO:** *O Endere√ßo do endpoint do M√©todo create(@Body() tarefa: Tarefa) ser√° igual ao endere√ßo do M√©todo findAll(). Como os verbos HTTP dos dois M√©todos s√£o diferentes, o mesmo endere√ßo pode ser de utilizado.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 28:** O decorator **@HttpCode(HttpStatus.CREATED)** indica que o M√©todo **create(@Body() tarefa: Tarefa)**, ter√° como **Resposta HTTP** padr√£o o status **CREATED ü°™ 201**, ou seja, quando a Resposta da Requisi√ß√£o for positiva (o Objeto for persistido no Banco de dados), ser√° retornado o **HTTP Status CREATED ü°™ 201**. Caso a Resposta seja negativa (algo deu errado), a Resposta depender√° do erro.

**Linha 29:** Criamos o M√©todo **create(@Body() tarefa: Tarefa)**, que promete retornar uma **Promise**, que ser√° enviada pela Classe TarefaService, contendo um Objeto da Classe Tarefa. 

**@Body():** Este decorator **insere o Objeto tarefa enviado no corpo da Requisi√ß√£o**, no Objeto tarefa (par√¢metro) do M√©todo **create(@Body() tarefa: Tarefa)**;

**Linha 30:** Executa o M√©todo **create(tarefa: Tarefa)**, **M√©todo da Classe TarefaService**, que retornar√° o Objeto da Classe Tarefa persistido no Banco de dados. 

3. Ap√≥s a implementa√ß√£o do M√©todo **create(@Body() tarefa: Tarefa)**, observe que a linha 1 do c√≥digo ser√° atualizada com alguns novos pacotes, como mostra a figura abaixo (indicado em amarelo):

<div align="left"><img src="https://i.imgur.com/nhaNis6.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documenta√ß√£o: HTTP Request Methods</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documenta√ß√£o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers" target="_blank"><b>Documenta√ß√£o: <i>Classe Controladora</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe Controladora</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/controllers/tarefa.controller.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaController</b></a></div>

<br /><br />


<h2>üë£ Passo 03 - Executar o projeto</h2>

1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/kXggbYz.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **blogpessoal**, caso n√£o esteja em execu√ß√£o. 

```bash
npm run start:dev
```

3. Se tudo deu certo, observe na imagem abaixo, na regi√£o indicada em amarelo, que o endpoint do tipo **POST**, apontando para o caminho (rota) **/tarefas**, foi disponibilizado.

<div align="center"><img src="https://i.imgur.com/giphjYH.png" title="source: imgur.com" /></div>

<br />


<h2>üë£ Passo 04 - Testar o M√©todo create no Insomnia</h2>

Agora vamos criar a Requisi√ß√£o para o **M√©todo create(tarefa: Tarefa)**:


1. Clique com o bot√£o direito do mouse sobre a **Pasta Tarefa** para abrir o menu e clique na op√ß√£o **New Request**.

<div align="center"><img src="https://i.imgur.com/6CwyPRd.png?1" title="source: imgur.com" /></div>

2.  Ser√° criada uma nova Requisi√ß√£o (New Request) dentro da pasta **Tarefa**.

<div align="center"><img src="https://i.imgur.com/ZRXvMAk.png" title="source: imgur.com" /></div>

3. D√™ um duplo clique sobre a nova Requisi√ß√£o (**New Request**), informe o nome da Requisi√ß√£o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/bEGMcnl.png?1" title="source: imgur.com" /></div>

4. Selecione o M√©todo HTTP que ser√° utilizado (**POST**) na Requisi√ß√£o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/TLBY2tJ.png" title="source: imgur.com" /></div>

5. No item **Body**, vamos alterar para **JSON**, como mostra a imagem abaixo. Desta forma poderemos enviar os dados do Objeto Tarefa no Corpo da Requisi√ß√£o, no formato JSON.

<div align="center"><img src="https://i.imgur.com/PxOpzFd.png" title="source: imgur.com" /></div>

6. Observe que o item **Body** ser√° renomeado para **JSON**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/8hDNIbh.png" title="source: imgur.com" /></div>

7. Configure o endere√ßo da Requisi√ß√£o conforme a imagem abaixo: 

<div align="center"><img src="https://i.imgur.com/9J4g1u1.png" title="source: imgur.com" /></div>

8. No item marcado em amarelo na imagem acima, informe o endere√ßo (endpoint) da Requisi√ß√£o. A Requisi√ß√£o **Cadastrar Tarefa** foi configurada da seguinte maneira:

- A primeira parte do endere√ßo (http://localhost:4000) √© o endere√ßo do nosso servidor local. Quando a aplica√ß√£o estiver na nuvem, ele ser√° substitu√≠do pelo endere√ßo da nuvem (**Exemplo:** http://nomedaaplicacao.herokuapp.com).
- A segunda parte do endere√ßo √© o **endpoint** configurado no decorator ***@Controller***, em nosso caso **/tarefas**.  

4. Na guia **JSON**, precisamos inserir um **JSON** com os dados que ser√£o inseridos na nova tarefa. Lembrando que no padr√£o JSON: **o texto antes dos 2 pontos** (:) √© o **Atributo** da Classe e **o texto depois dos 2 pontos** (:) √© o **dado** que ser√° cadastrado no Atributo.  Os Atributos s√£o separados por virgula, como mostra a imagem acima.

   | <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATEN√á√ÉO:** Observe que no M√©todo **POST n√£o √© necess√°rio enviar o Atributo id** (ser√° gerado pelo Banco de dados) no JSON.</div> |
   | ------------------------------------------------------------ | ------------------------------------------------------------ |

5. Para testar a Requisi√ß√£o, com a aplica√ß√£o rodando, clique no bot√£o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="50px"/>.

6. O resultado da Requisi√ß√£o voc√™ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/bBjAR9r.png" title="source: imgur.com" /></div>

8. Observe que a aplica√ß√£o retorna al√©m dos dados que foram persistidos no Banco de dados com o id, ela tamb√©m retorna um **HTTP Status 201 ü°™ CREATED** (indicado em verde na imagem acima). Este Status indica que a Requisi√ß√£o foi bem sucedida!

9. Caso os Atributos **nome**,  **descricao** ou **responsavel** sejam nulos ou em branco (indicado em amarelo), ou no Atributo **nome** seja enviada uma string com mais de 30 caracteres, a aplica√ß√£o retornar√° o **HTTP Status 400 ü°™ BAD_REQUEST** (indicado em verde), devido as valida√ß√µes que foram inseridas na Classe Tarefa (**@IsNotEmpty** e **@MaxLength(30)**), como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/998tb1p.png" title="source: imgur.com" /></div>

<br />

<h2>üë£ Passo 05 - Criar o M√©todo update(tarefa: Tarefa) na Classe TarefaService</h2>

Vamos implementar o M√©todo **update(tarefa: Tarefa)** na Classe TarefaService. Tra√ßando um paralelo com o MySQL, seria o equivalente a instru√ß√£o: <code>UPDATE tb_tarefas SET nome="Nome", descricao="Descri√ß√£o", responsavel="Respons√°vel", data="2022-07-26", status=true WHERE id = id;</code>.

1. Abra a Classe **Tarefa Service**, localizada na pasta **src/tarefa/services**.

<div align="center"><img src="https://i.imgur.com/KfZcpNC.png" title="source: imgur.com" /></div>

2. Insira o c√≥digo depois do M√©todo **create(@Body() tarefa: Tarefa)**.

<div align="left"><img src="https://i.imgur.com/f4Zkfjd.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo do M√©todo:

**Linha 43:** Criamos o M√©todo Ass√≠ncrono (async), chamado **update(tarefa: Tarefa)**, que promete retornar uma **Promise** contendo um Objeto da Classe Tarefa, que foi atualizado no Banco de dados da aplica√ß√£o. 

Observe que o M√©todo **update(tarefa: Tarefa)** possui um par√¢metro do tipo **Tarefa**, chamado **tarefa**. Esta vari√°vel receber√° um Objeto da Classe Tarefa, que ser√° enviado no Corpo da Requisi√ß√£o (Request Body), conforme as regras definidas na Entidade Tarefa (Tamanho, Pode ser Nulo, Pode ser vazio, entre outras). O Objeto tarefa ser√° enviado pelo M√©todo da **Classe TarefaController**, atrav√©s de um **JSON**, semelhante ao exemplo abaixo: 

```json
{
    "id" : 3,
    "nome" : "Tarefa 03 - Atualizada",
    "descricao" :"Descri√ß√£o da Tarefa 03 - Atualizada!",
    "responsavel" : "Respons√°vel 03",
    "data" : "2022-07-25",
    "status" : true
}
```

Observe que dieferente do M√©todo **create(tarefa: Tarefa)**, **o id tamb√©m deve ser enviado para identificar a tarefa que ser√° atualizada**. 

**Linha 44:** Criamos um Objeto da Classe Tarefa, chamado **buscaTarefa**, para receber o resultado da execu√ß√£o do M√©todo **findById(id: number)**, da Classe **TarefaService**. O objetivo √© checar se a Tarefa que ser√° atualizada existe, atrav√©s da busca pelo id.  Observe que na chamada do M√©todo **findById(id: number)** foi inserido o comando **await** (aguarde), que na pr√°tica significa espere que a **Promise** seja resolvida (o Objeto Tarefa seja encontrado), antes de retornar a execu√ß√£o do M√©todo e o valor resolvido para a Classe que acionou o M√©todo.

**Linha 46:** Verifica se **buscaTarefa √© nulo** ou se o **id da tarefa(JSON) √© nulo**. Caso o usu√°rio digite um id que n√£o exista, o Objeto buscaTarefa ser√° nulo, causando um erro na nossa aplica√ß√£o. Caso o usu√°rio n√£o informe o valor do Atributo id no Objeto tarefa (JSON), que foi enviado no Corpo da Requisi√ß√£o, ser√° criado um novo Objeto, com um novo id. Estas duas checagens s√£o para evitar estes dois erros.

**Linha 47:** Se o Objeto buscaTarefa ou o Atributo id do Objeto tarefa(JSON) for nulo, ser√° retornado o HTTP Status **NOT FOUND ü°™ 404** (N√£o Encontrado!).

**Linha 49:** Retorna a execu√ß√£o do M√©todo **save()**, da Interface **tarefaRepository**. O resultado da execu√ß√£o do M√©todo **save()**, ser√° um Objeto da Classe Tarefa atualizado no Banco de dados, na tabela **tb_tarefas**. 

Observe que na instru√ß√£o **return** foi inserido o comando **await** (aguarde), que na pr√°tica significa espere que a **Promise** seja resolvida (os Objetos Tarefa sejam atualizados), antes de retornar a execu√ß√£o do M√©todo e o valor resolvido para a Classe que acionou o M√©todo.

No caso de uma atualiza√ß√£o dos dados, o retorno esperado do M√©todo **save()** ser√° a confirma√ß√£o do Objeto persistido com as atualiza√ß√µes, no formato JSON, como mostra o exemplo abaixo:

```json
{
	"id": 3,
	"nome": "Tarefa 03 - Atualizada",
	"descricao": "Descri√ß√£o da Tarefa 03 - Atualizada!",
	"responsavel": "Respons√°vel 03",
	"data": "2022-07-25",
	"status": true
}
```

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores Customizados - Classe de Servi√ßo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/find-options" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - M√©todo de busca find()</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documenta√ß√£o: Promise</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/async_function" target="_blank"><b>Documenta√ß√£o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documenta√ß√£o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/services/tarefa.service.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaService</b></a></div>

<br />

<h2>üë£ Passo 06 - Criar o M√©todo update(tarefa: Tarefa) na Classe TarefaController</h2>

Vamos implementar o M√©todo **update(@Body() tarefa: Tarefa)** na Classe TarefaController, que tem como objetivo executar o M√©todo com o mesmo nome na Classe de Servi√ßo TarefaService. 

1. Abra a Classe **TarefaController**, localizada na pasta **src/tarefa/controllers**.

<div align="center"><img src="https://i.imgur.com/4PV6We4.png" title="source: imgur.com" /></div>

2. Insira o c√≥digo depois do M√©todo **create(@Body() tarefa: Tarefa)**.

<div align="left"><img src="https://i.imgur.com/jFsI13S.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo do M√©todo:

**Linha 33:** O decorator **@Put()** mapeia todas as Requisi√ß√µes **HTTP PUT**, enviadas para um endere√ßo espec√≠fico, chamado **endpoint**, dentro do M√≥dulo Tarefa, para um M√©todo espec√≠fico que responder√° a Requisi√ß√£o, ou seja, ele indica que o M√©todo **update(@Body() tarefa: Tarefa)**, responder√° a todas as requisi√ß√µes do tipo **HTTP PUT**, enviadas no endere√ßo **http://localhost:4000/tarefas/**.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATEN√á√ÉO:** *O Endere√ßo do endpoint do M√©todo update(@Body() tarefa: Tarefa) ser√° igual ao endere√ßo do M√©todo findAll() e do M√©todo create(@Body() tarefa: Tarefa). Como os verbos HTTP dos tr√™s M√©todos s√£o diferentes, o mesmo endere√ßo pode ser utilizado.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 34:** O decorator **@HttpCode(HttpStatus.OK)** indica que o M√©todo **update(@Body() tarefa: Tarefa)**, ter√° como **Resposta HTTP** padr√£o **OK ü°™ 200**, ou seja, quando a Resposta da Requisi√ß√£o for positiva, ser√° retornado o **HTTP Status OK ü°™ 200**. Caso a Resposta seja negativa (algo deu errado), a Resposta depender√° do erro.

**Linha 35** Criamos o M√©todo **update(@Body() tarefa: Tarefa)**, que promete retornar uma **Promise**, que ser√° enviada pela Classe TarefaService, contendo um Objeto da Classe Tarefa. 

**@Body():** Este decorator **insere o Objeto tarefa enviado no corpo da Requisi√ß√£o**, no Objeto **tarefa** (par√¢metro) do M√©todo **update(@Body() tarefa: Tarefa)**;

**Linha 36:** Executa o M√©todo **update(tarefa: Tarefa)**, **M√©todo da Classe TarefaService**, que retornar√° **o Objeto da Classe Tarefa** atualizado no Banco de dados. 

3. Ap√≥s a implementa√ß√£o do M√©todo **update(@Body() tarefa: Tarefa)**, observe que a linha 1 do c√≥digo ser√° atualizada com um novo pacote, como mostra a figura abaixo (indicado em amarelo):

<div align="left"><img src="https://i.imgur.com/7a7wu2Y.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documenta√ß√£o: HTTP Request Methods</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documenta√ß√£o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers" target="_blank"><b>Documenta√ß√£o: <i>Classe Controladora</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documenta√ß√£o: <i>Provedores - Classe Controladora</i></b></a></div>

<br />
<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/controllers/tarefa.controller.ts" target="_blank"><b>C√≥digo fonte da Classe TarefaController</b></a></div>

<br />


<h2>üë£ Passo 07 - Testar no Insomnia o M√©todo update</h2>

Agora vamos criar a Requisi√ß√£o para o **M√©todo update(tarefa: Tarefa)**:

1. Clique com o bot√£o direito do mouse sobre a **Pasta Tarefa** para abrir o menu e clique na op√ß√£o **New Request**.

<div align="center"><img src="https://i.imgur.com/6CwyPRd.png?1" title="source: imgur.com" /></div>

2.  Ser√° criada uma nova Requisi√ß√£o (New Request) dentro da pasta **Tarefa**.

<div align="center"><img src="https://i.imgur.com/ZRXvMAk.png" title="source: imgur.com" /></div>

3. D√™ um duplo clique sobre a nova Requisi√ß√£o (**New Request**), informe o nome da Requisi√ß√£o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/LzYHKYB.png" title="source: imgur.com" /></div>

4. Selecione o M√©todo HTTP que ser√° utilizado (**PUT**) na Requisi√ß√£o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/z6dWHYj.png" title="source: imgur.com" /></div>

5. No item **Body**, vamos alterar para **JSON**, como mostra a imagem abaixo. Desta forma poderemos enviar os dados do Objeto Tarefa no Corpo da Requisi√ß√£o, no formato JSON.

<div align="center"><img src="https://i.imgur.com/PxOpzFd.png" title="source: imgur.com" /></div>

6. Observe que o item **Body** ser√° renomeado para **JSON**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/8hDNIbh.png" title="source: imgur.com" /></div>

7. Configure o endere√ßo da Requisi√ß√£o conforme a imagem abaixo: 

<div align="center"><img src="https://i.imgur.com/JU2LYj1.png" title="source: imgur.com" /></div>

8. No item marcado em amarelo na imagem acima, informe o endere√ßo (endpoint) da Requisi√ß√£o. A Requisi√ß√£o **Atualizar Tarefa** foi configurada da seguinte maneira:

   - A primeira parte do endere√ßo (http://localhost:4000) √© o endere√ßo do nosso servidor local. Quando a aplica√ß√£o estiver na nuvem, ele ser√° substitu√≠do pelo endere√ßo da nuvem (**Exemplo:** http://nomedaaplicacao.herokuapp.com).
   - A segunda parte do endere√ßo √© o **endpoint** configurado no decorator ***@Controller***, em nosso caso **/tarefas**.  
   
5. Na guia **JSON**, precisamos inserir um **JSON** com os dados que ser√£o inseridos na nova tarefa. Lembrando que no padr√£o JSON: **o texto antes dos 2 pontos** (:) √© o **Atributo** da Classe e **o texto depois dos 2 pontos** (:) √© o **dado** que ser√° cadastrado no Atributo.  Os Atributos s√£o separados por virgula, como mostra a imagem acima.

   | <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATEN√á√ÉO:** Observe que no M√©todo **PUT √© necess√°rio enviar o Atributo id** no JSON para identificar a Tarefa que ser√° atualizada. </div> |
   | ------------------------------------------------------------ | ------------------------------------------------------------ |

6. Para testar a Requisi√ß√£o, com a aplica√ß√£o rodando, clique no bot√£o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="60px"/>.

7. O resultado da Requisi√ß√£o voc√™ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/zyWKPHU.png" title="source: imgur.com" /></div>

8. Observe que a aplica√ß√£o retorna al√©m dos dados que foram atualizados no Banco de dados, ela tamb√©m retorna um **HTTP Status 200 ü°™ OK** (indicado em verde na imagem acima). Este Status indica que a Requisi√ß√£o foi bem sucedida!

9. Caso a Tarefa n√£o seja encontrada, ser√° retornado o **HTTP Status 404 ü°™ NOT_FOUND**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/fV9ab4L.png" title="source: imgur.com" /></div>

10. Caso os Atributos **nome**, **descricao** ou **responsavel** sejam nulos ou em branco (indicado em amarelo), ou no Atributo **nome** seja enviada uma string com mais de 30 caracteres, a aplica√ß√£o retornar√° o **HTTP Status 400 ü°™ BAD_REQUEST** (indicado em verde), devido as valida√ß√µes que foram inseridas na Classe Tarefa (**@IsNotEmpty** e **@MaxLength(30)**), como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/P0S9xGa.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/tree/07_Cadastrar_Atualizar_Tarefas" target="_blank"><b>C√≥digo fonte do projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>
