<h1>Projeto 02 - Todo-List - Classe TarefaController e TarefaService - Mﾃｩtodos Cadastrar e Atualizar</h1>

O que veremos por aqui:

1. Criar o Mﾃｩtodo create(tarefa: Tarefa) na Classe TarefaService
2. Criar o Mﾃｩtodo create(tarefa: Tarefa) na Classe TarefaController
3. Criar o Mﾃｩtodo update(tarefa: Tarefa) na Classe TarefaService
4. Criar o Mﾃｩtodo update(tarefa: Tarefa) na Classe TarefaController
5. Testar os Mﾃｩtodos no Insomnia

<h2>1. O Mﾃｳdulo Tarefa</h2>

Nas etapas anteriores, comeﾃｧamos a construir as Classes **TarefaService** e **TarefaController** e implementamos os seguintes Mﾃｩtodos:

-  **findAll()**  ｡ｪ Retorna todos os Objetos da Classe Tarefa persistidos no Banco de dados.
-  **findById(id: number)** ｡ｪ Retorna um Objeto especﾃｭfico da Classe Tarefa persistido no Banco de dados. A Tarefa ﾃｩ identificada pelo Atributo id. 
-  **findByNome(nome: string)** ｡ｪ Retorna  todos os Objetos da Classe Tarefa persistidos no Banco de dados, cujo Atributo nome contenha (em qualquer parte) a String enviada no parﾃ｢metro nome do Mﾃｩtodo.   

Vamos continuar a construﾃｧﾃ｣o das Classes **TarefaService** e **TarefaController** implementando os Mﾃｩtodos **create(tarefa: Tarefa)**, que persistirﾃ｡ um novo Objeto da Classe Tarefa no Banco de dados e  **update(tarefa: Tarefa)**, que atualizarﾃ｡ um Objeto da Classe Tarefa persistido no Banco de dados.

```mermaid
classDiagram
class Tarefa {
  - id : number
  - nome : string
  - descricao: string
  - responsavel: string
  - data: Date
  - status: boolean
  - categoria: Categoria
  + findAll()
  + findById(id : number)
  + findByDescricao(descricao : string)
  + create(categoria : Categoria)
  + update(categoria : Categoria)
  + delete(id : number)
}
```

<h2>促 Passo 01 - Criar o Mﾃｩtodo create(tarefa: Tarefa) na Classe TarefaService</h2>

Vamos implementar o Mﾃｩtodo **create(tarefa: Tarefa)** na Classe TarefaService. Traﾃｧando um paralelo com o MySQL, seria o equivalente a instruﾃｧﾃ｣o: <code>INSERT INTO tb_tarefas(nome, descricao, responsavel, data, status)
VALUES ("Tarefa", "Descriﾃｧﾃ｣o da Tarefa", "Responsﾃ｡vel", "2022-07-22", true);</code>.

1. Abra a Classe **Tarefa Service**, localizada na pasta **src/tarefa/services**.

<div align="center"><img src="https://i.imgur.com/KfZcpNC.png" title="source: imgur.com" /></div>

2. Insira o cﾃｳdigo abaixo depois do Mﾃｩtodo **findByNome(nome: string)**.

<div align="left"><img src="https://i.imgur.com/pDufNkZ.png" title="source: imgur.com" /></div>

Vamos analisar o cﾃｳdigo do Mﾃｩtodo:

**Linha 39:** Criamos o Mﾃｩtodo Assﾃｭncrono (async), chamado **create(tarefa: Tarefa)**, que promete retornar uma **Promise** contendo um Objeto da Classe Tarefa, que foi persistido no Banco de dados da aplicaﾃｧﾃ｣o. 

Observe que o Mﾃｩtodo **create(tarefa: Tarefa)** possui um parﾃ｢metro do tipo **Tarefa**, chamado **tarefa**. Esta variﾃ｡vel receberﾃ｡ um Objeto da Classe Tarefa, que foi enviado no Corpo da Requisiﾃｧﾃ｣o (Request Body), conforme as regras definidas na Entidade Tarefa (Tamanho, Pode ser Nulo, Pode ser vazio, entre outras). O Objeto tarefa serﾃ｡ enviado pelo Mﾃｩtodo da **Classe TarefaController**, atravﾃｩs de um **JSON**, semelhante ao exemplo abaixo: 

```json
{
    "nome" : "Tarefa 03",
    "descricao" :"Descriﾃｧﾃ｣o da Tarefa 03",
    "responsavel" : "Responsﾃ｡vel 03",
    "data" : "2022-07-25",
    "status" : true
}
```

Observe que o Atributo **id nﾃ｣o serﾃ｡ informado porquﾃｪ serﾃ｡ atribuﾃｭdo pelo Banco de dados** apﾃｳs o Objeto ser persistido no Banco de dados.

**Linha 40:** Retorna a execuﾃｧﾃ｣o do Mﾃｩtodo **save()**, da Interface **tarefaRepository**. O resultado da execuﾃｧﾃ｣o do Mﾃｩtodo **save()**, serﾃ｡ um Objeto da Classe Tarefa persistido (salvo) no Banco de dados, na tabela **tb_tarefas**.  

Observe que na instruﾃｧﾃ｣o **return** foi inserido o comando **await** (aguarde), que na prﾃ｡tica significa espere que a **Promise** seja resolvida (o Objeto Tarefa seja persistido), antes de retornar a execuﾃｧﾃ｣o do Mﾃｩtodo e o valor resolvido para a Classe que acionou o Mﾃｩtodo.

No caso de uma persistﾃｪncia dos dados, o retorno esperado do Mﾃｩtodo **save()** serﾃ｡ a confirmaﾃｧﾃ｣o do Objeto persistido, no formato JSON, como mostra o exemplo abaixo:

```json
{
    "id" : 3,
	"nome": "Tarefa 03",
	"descricao": "Descriﾃｧﾃ｣o da Tarefa 03",
	"responsavel": "Responsﾃ｡vel 03",
	"data": "2022-07-25",
	"status": true
}
```

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Provedores - Classe de Serviﾃｧo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Provedores Customizados - Classe de Serviﾃｧo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/find-options" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>TypeORM - Mﾃｩtodo de busca find()</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documentaﾃｧﾃ｣o: Promise</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/async_function" target="_blank"><b>Documentaﾃｧﾃ｣o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documentaﾃｧﾃ｣o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/services/tarefa.service.ts" target="_blank"><b>Cﾃｳdigo fonte da Classe TarefaService</b></a></div>

<br /><br />


<h2>促 Passo 02 - Criar o Mﾃｩtodo create(tarefa: Tarefa) na Classe TarefaController</h2>

Vamos implementar o Mﾃｩtodo **create(@Body() tarefa: Tarefa)** na Classe TarefaController, que tem como objetivo executar o Mﾃｩtodo com o mesmo nome na Classe de Serviﾃｧo TarefaService. 

1. Abra a Classe **TarefaController**, localizada na pasta **src/tarefa/controllers**.

<div align="center"><img src="https://i.imgur.com/4PV6We4.png" title="source: imgur.com" /></div>

2. Insira o cﾃｳdigo depois do Mﾃｩtodo **findByNome(nome: string)**.

<div align="left"><img src="https://i.imgur.com/vzclSNN.png" title="source: imgur.com" /></div>

Vamos analisar o cﾃｳdigo do Mﾃｩtodo:

**Linha 27:** O decorator **@Post()** mapeia todas as Requisiﾃｧﾃｵes **HTTP POST**, enviadas para um endereﾃｧo especﾃｭfico, chamado **endpoint**, dentro do Mﾃｳdulo Tarefa, para um Mﾃｩtodo especﾃｭfico que responderﾃ｡ a Requisiﾃｧﾃ｣o, ou seja, ele indica que o Mﾃｩtodo **create(@Body() tarefa: Tarefa)**, responderﾃ｡ a todas as requisiﾃｧﾃｵes do tipo **HTTP POST**, enviadas no endereﾃｧo **http://localhost:4000/tarefas/**.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="200px"/> | <div align="left"> **ATENﾃﾃグ:** *O Endereﾃｧo do endpoint do Mﾃｩtodo create(@Body() tarefa: Tarefa) serﾃ｡ igual ao endereﾃｧo do Mﾃｩtodo findAll(). Como os verbos HTTP dos dois Mﾃｩtodos sﾃ｣o diferentes, o mesmo endereﾃｧo pode ser de utilizado.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 28:** O decorator **@HttpCode(HttpStatus.CREATED)** indica que o Mﾃｩtodo **create(@Body() tarefa: Tarefa)**, terﾃ｡ como **Resposta HTTP** padrﾃ｣o o status **CREATED ｡ｪ 201**, ou seja, quando a Resposta da Requisiﾃｧﾃ｣o for positiva (o Objeto for persistido no Banco de dados), serﾃ｡ retornado o **HTTP Status CREATED ｡ｪ 201**. Caso a Resposta seja negativa (algo deu errado), a Resposta dependerﾃ｡ do erro.

**Linha 29:** Criamos o Mﾃｩtodo **create(@Body() tarefa: Tarefa)**, que promete retornar uma **Promise**, que serﾃ｡ enviada pela Classe TarefaService, contendo um Objeto da Classe Tarefa. 

**@Body():** Este decorator **insere o Objeto tarefa enviado no corpo da Requisiﾃｧﾃ｣o**, no Objeto tarefa (parﾃ｢metro) do Mﾃｩtodo **create(@Body() tarefa: Tarefa)**;

**Linha 30:** Executa o Mﾃｩtodo **create(tarefa: Tarefa)**, **Mﾃｩtodo da Classe TarefaService**, que retornarﾃ｡ o Objeto da Classe Tarefa persistido no Banco de dados. 

3. Apﾃｳs a implementaﾃｧﾃ｣o do Mﾃｩtodo **create(@Body() tarefa: Tarefa)**, observe que a linha 1 do cﾃｳdigo serﾃ｡ atualizada com alguns novos pacotes, como mostra a figura abaixo (indicado em amarelo):

<div align="left"><img src="https://i.imgur.com/nhaNis6.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documentaﾃｧﾃ｣o: HTTP Request Methods</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documentaﾃｧﾃ｣o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Classe Controladora</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Provedores - Classe Controladora</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/controllers/tarefa.controller.ts" target="_blank"><b>Cﾃｳdigo fonte da Classe TarefaController</b></a></div>

<br /><br />


<h2>促 Passo 03 - Executar o projeto</h2>

1. Verifique se vocﾃｪ estﾃ｡ dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/kXggbYz.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **blogpessoal**, caso nﾃ｣o esteja em execuﾃｧﾃ｣o. 

```bash
npm run start:dev
```

3. Se tudo deu certo, observe na imagem abaixo, na regiﾃ｣o indicada em amarelo, que o endpoint do tipo **POST**, apontando para o caminho (rota) **/tarefas**, foi disponibilizado.

<div align="center"><img src="https://i.imgur.com/giphjYH.png" title="source: imgur.com" /></div>

<br />


<h2>促 Passo 04 - Testar o Mﾃｩtodo create no Insomnia</h2>

Agora vamos criar a Requisiﾃｧﾃ｣o para o **Mﾃｩtodo create(tarefa: Tarefa)**:


1. Clique com o botﾃ｣o direito do mouse sobre a **Pasta Tarefa** para abrir o menu e clique na opﾃｧﾃ｣o **New Request**.

<div align="center"><img src="https://i.imgur.com/6CwyPRd.png?1" title="source: imgur.com" /></div>

2.  Serﾃ｡ criada uma nova Requisiﾃｧﾃ｣o (New Request) dentro da pasta **Tarefa**.

<div align="center"><img src="https://i.imgur.com/ZRXvMAk.png" title="source: imgur.com" /></div>

3. Dﾃｪ um duplo clique sobre a nova Requisiﾃｧﾃ｣o (**New Request**), informe o nome da Requisiﾃｧﾃ｣o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/bEGMcnl.png?1" title="source: imgur.com" /></div>

4. Selecione o Mﾃｩtodo HTTP que serﾃ｡ utilizado (**POST**) na Requisiﾃｧﾃ｣o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/TLBY2tJ.png" title="source: imgur.com" /></div>

5. No item **Body**, vamos alterar para **JSON**, como mostra a imagem abaixo. Desta forma poderemos enviar os dados do Objeto Tarefa no Corpo da Requisiﾃｧﾃ｣o, no formato JSON.

<div align="center"><img src="https://i.imgur.com/PxOpzFd.png" title="source: imgur.com" /></div>

6. Observe que o item **Body** serﾃ｡ renomeado para **JSON**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/8hDNIbh.png" title="source: imgur.com" /></div>

7. Configure o endereﾃｧo da Requisiﾃｧﾃ｣o conforme a imagem abaixo: 

<div align="center"><img src="https://i.imgur.com/9J4g1u1.png" title="source: imgur.com" /></div>

8. No item marcado em amarelo na imagem acima, informe o endereﾃｧo (endpoint) da Requisiﾃｧﾃ｣o. A Requisiﾃｧﾃ｣o **Cadastrar Tarefa** foi configurada da seguinte maneira:

- A primeira parte do endereﾃｧo (http://localhost:4000) ﾃｩ o endereﾃｧo do nosso servidor local. Quando a aplicaﾃｧﾃ｣o estiver na nuvem, ele serﾃ｡ substituﾃｭdo pelo endereﾃｧo da nuvem (**Exemplo:** http://nomedaaplicacao.herokuapp.com).
- A segunda parte do endereﾃｧo ﾃｩ o **endpoint** configurado no decorator ***@Controller***, em nosso caso **/tarefas**.  

4. Na guia **JSON**, precisamos inserir um **JSON** com os dados que serﾃ｣o inseridos na nova tarefa. Lembrando que no padrﾃ｣o JSON: **o texto antes dos 2 pontos** (:) ﾃｩ o **Atributo** da Classe e **o texto depois dos 2 pontos** (:) ﾃｩ o **dado** que serﾃ｡ cadastrado no Atributo.  Os Atributos sﾃ｣o separados por virgula, como mostra a imagem acima.

   | <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATENﾃﾃグ:** Observe que no Mﾃｩtodo **POST nﾃ｣o ﾃｩ necessﾃ｡rio enviar o Atributo id** (serﾃ｡ gerado pelo Banco de dados) no JSON.</div> |
   | ------------------------------------------------------------ | ------------------------------------------------------------ |

5. Para testar a Requisiﾃｧﾃ｣o, com a aplicaﾃｧﾃ｣o rodando, clique no botﾃ｣o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="50px"/>.

6. O resultado da Requisiﾃｧﾃ｣o vocﾃｪ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/bBjAR9r.png" title="source: imgur.com" /></div>

8. Observe que a aplicaﾃｧﾃ｣o retorna alﾃｩm dos dados que foram persistidos no Banco de dados com o id, ela tambﾃｩm retorna um **HTTP Status 201 ｡ｪ CREATED** (indicado em verde na imagem acima). Este Status indica que a Requisiﾃｧﾃ｣o foi bem sucedida!

9. Caso os Atributos **nome**,  **descricao** ou **responsavel** sejam nulos ou em branco (indicado em amarelo), ou no Atributo **nome** seja enviada uma string com mais de 30 caracteres, a aplicaﾃｧﾃ｣o retornarﾃ｡ o **HTTP Status 400 ｡ｪ BAD_REQUEST** (indicado em verde), devido as validaﾃｧﾃｵes que foram inseridas na Classe Tarefa (**@IsNotEmpty** e **@MaxLength(30)**), como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/998tb1p.png" title="source: imgur.com" /></div>

<br />

<h2>促 Passo 05 - Criar o Mﾃｩtodo update(tarefa: Tarefa) na Classe TarefaService</h2>

Vamos implementar o Mﾃｩtodo **update(tarefa: Tarefa)** na Classe TarefaService. Traﾃｧando um paralelo com o MySQL, seria o equivalente a instruﾃｧﾃ｣o: <code>UPDATE tb_tarefas SET nome="Nome", descricao="Descriﾃｧﾃ｣o", responsavel="Responsﾃ｡vel", data="2022-07-26", status=true WHERE id = id;</code>.

1. Abra a Classe **Tarefa Service**, localizada na pasta **src/tarefa/services**.

<div align="center"><img src="https://i.imgur.com/KfZcpNC.png" title="source: imgur.com" /></div>

2. Insira o cﾃｳdigo depois do Mﾃｩtodo **create(@Body() tarefa: Tarefa)**.

<div align="left"><img src="https://i.imgur.com/f4Zkfjd.png" title="source: imgur.com" /></div>

Vamos analisar o cﾃｳdigo do Mﾃｩtodo:

**Linha 43:** Criamos o Mﾃｩtodo Assﾃｭncrono (async), chamado **update(tarefa: Tarefa)**, que promete retornar uma **Promise** contendo um Objeto da Classe Tarefa, que foi atualizado no Banco de dados da aplicaﾃｧﾃ｣o. 

Observe que o Mﾃｩtodo **update(tarefa: Tarefa)** possui um parﾃ｢metro do tipo **Tarefa**, chamado **tarefa**. Esta variﾃ｡vel receberﾃ｡ um Objeto da Classe Tarefa, que serﾃ｡ enviado no Corpo da Requisiﾃｧﾃ｣o (Request Body), conforme as regras definidas na Entidade Tarefa (Tamanho, Pode ser Nulo, Pode ser vazio, entre outras). O Objeto tarefa serﾃ｡ enviado pelo Mﾃｩtodo da **Classe TarefaController**, atravﾃｩs de um **JSON**, semelhante ao exemplo abaixo: 

```json
{
    "id" : 3,
    "nome" : "Tarefa 03 - Atualizada",
    "descricao" :"Descriﾃｧﾃ｣o da Tarefa 03 - Atualizada!",
    "responsavel" : "Responsﾃ｡vel 03",
    "data" : "2022-07-25",
    "status" : true
}
```

Observe que dieferente do Mﾃｩtodo **create(tarefa: Tarefa)**, **o id tambﾃｩm deve ser enviado para identificar a tarefa que serﾃ｡ atualizada**. 

**Linha 44:** Criamos um Objeto da Classe Tarefa, chamado **buscaTarefa**, para receber o resultado da execuﾃｧﾃ｣o do Mﾃｩtodo **findById(id: number)**, da Classe **TarefaService**. O objetivo ﾃｩ checar se a Tarefa que serﾃ｡ atualizada existe, atravﾃｩs da busca pelo id.  Observe que na chamada do Mﾃｩtodo **findById(id: number)** foi inserido o comando **await** (aguarde), que na prﾃ｡tica significa espere que a **Promise** seja resolvida (o Objeto Tarefa seja encontrado), antes de retornar a execuﾃｧﾃ｣o do Mﾃｩtodo e o valor resolvido para a Classe que acionou o Mﾃｩtodo.

**Linha 46:** Verifica se **buscaTarefa ﾃｩ nulo** ou se o **id da tarefa(JSON) ﾃｩ nulo**. Caso o usuﾃ｡rio digite um id que nﾃ｣o exista, o Objeto buscaTarefa serﾃ｡ nulo, causando um erro na nossa aplicaﾃｧﾃ｣o. Caso o usuﾃ｡rio nﾃ｣o informe o valor do Atributo id no Objeto tarefa (JSON), que foi enviado no Corpo da Requisiﾃｧﾃ｣o, serﾃ｡ criado um novo Objeto, com um novo id. Estas duas checagens sﾃ｣o para evitar estes dois erros.

**Linha 47:** Se o Objeto buscaTarefa ou o Atributo id do Objeto tarefa(JSON) for nulo, serﾃ｡ retornado o HTTP Status **NOT FOUND ｡ｪ 404** (Nﾃ｣o Encontrado!).

**Linha 49:** Retorna a execuﾃｧﾃ｣o do Mﾃｩtodo **save()**, da Interface **tarefaRepository**. O resultado da execuﾃｧﾃ｣o do Mﾃｩtodo **save()**, serﾃ｡ um Objeto da Classe Tarefa atualizado no Banco de dados, na tabela **tb_tarefas**. 

Observe que na instruﾃｧﾃ｣o **return** foi inserido o comando **await** (aguarde), que na prﾃ｡tica significa espere que a **Promise** seja resolvida (os Objetos Tarefa sejam atualizados), antes de retornar a execuﾃｧﾃ｣o do Mﾃｩtodo e o valor resolvido para a Classe que acionou o Mﾃｩtodo.

No caso de uma atualizaﾃｧﾃ｣o dos dados, o retorno esperado do Mﾃｩtodo **save()** serﾃ｡ a confirmaﾃｧﾃ｣o do Objeto persistido com as atualizaﾃｧﾃｵes, no formato JSON, como mostra o exemplo abaixo:

```json
{
	"id": 3,
	"nome": "Tarefa 03 - Atualizada",
	"descricao": "Descriﾃｧﾃ｣o da Tarefa 03 - Atualizada!",
	"responsavel": "Responsﾃ｡vel 03",
	"data": "2022-07-25",
	"status": true
}
```

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Provedores - Classe de Serviﾃｧo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/fundamentals/custom-providers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Provedores Customizados - Classe de Serviﾃｧo</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/find-options" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>TypeORM - Mﾃｩtodo de busca find()</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Global_Objects/Promise" target="_blank"><b>Documentaﾃｧﾃ｣o: Promise</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/async_function" target="_blank"><b>Documentaﾃｧﾃ｣o: Async</b></a></div>

<div align="left"><img src="https://i.imgur.com/r9lrbPG.png" title="source: imgur.com" width="30px"/> <a href="https://developer.mozilla.org/pt-BR/docs/Web/JavaScript/Reference/Operators/await" target="_blank"><b>Documentaﾃｧﾃ｣o: Await</b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/services/tarefa.service.ts" target="_blank"><b>Cﾃｳdigo fonte da Classe TarefaService</b></a></div>

<br />

<h2>促 Passo 06 - Criar o Mﾃｩtodo update(tarefa: Tarefa) na Classe TarefaController</h2>

Vamos implementar o Mﾃｩtodo **update(@Body() tarefa: Tarefa)** na Classe TarefaController, que tem como objetivo executar o Mﾃｩtodo com o mesmo nome na Classe de Serviﾃｧo TarefaService. 

1. Abra a Classe **TarefaController**, localizada na pasta **src/tarefa/controllers**.

<div align="center"><img src="https://i.imgur.com/4PV6We4.png" title="source: imgur.com" /></div>

2. Insira o cﾃｳdigo depois do Mﾃｩtodo **create(@Body() tarefa: Tarefa)**.

<div align="left"><img src="https://i.imgur.com/jFsI13S.png" title="source: imgur.com" /></div>

Vamos analisar o cﾃｳdigo do Mﾃｩtodo:

**Linha 33:** O decorator **@Put()** mapeia todas as Requisiﾃｧﾃｵes **HTTP PUT**, enviadas para um endereﾃｧo especﾃｭfico, chamado **endpoint**, dentro do Mﾃｳdulo Tarefa, para um Mﾃｩtodo especﾃｭfico que responderﾃ｡ a Requisiﾃｧﾃ｣o, ou seja, ele indica que o Mﾃｩtodo **update(@Body() tarefa: Tarefa)**, responderﾃ｡ a todas as requisiﾃｧﾃｵes do tipo **HTTP PUT**, enviadas no endereﾃｧo **http://localhost:4000/tarefas/**.

| <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="400px"/> | <div align="left"> **ATENﾃﾃグ:** *O Endereﾃｧo do endpoint do Mﾃｩtodo update(@Body() tarefa: Tarefa) serﾃ｡ igual ao endereﾃｧo do Mﾃｩtodo findAll() e do Mﾃｩtodo create(@Body() tarefa: Tarefa). Como os verbos HTTP dos trﾃｪs Mﾃｩtodos sﾃ｣o diferentes, o mesmo endereﾃｧo pode ser utilizado.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 34:** O decorator **@HttpCode(HttpStatus.OK)** indica que o Mﾃｩtodo **update(@Body() tarefa: Tarefa)**, terﾃ｡ como **Resposta HTTP** padrﾃ｣o **OK ｡ｪ 200**, ou seja, quando a Resposta da Requisiﾃｧﾃ｣o for positiva, serﾃ｡ retornado o **HTTP Status OK ｡ｪ 200**. Caso a Resposta seja negativa (algo deu errado), a Resposta dependerﾃ｡ do erro.

**Linha 35** Criamos o Mﾃｩtodo **update(@Body() tarefa: Tarefa)**, que promete retornar uma **Promise**, que serﾃ｡ enviada pela Classe TarefaService, contendo um Objeto da Classe Tarefa. 

**@Body():** Este decorator **insere o Objeto tarefa enviado no corpo da Requisiﾃｧﾃ｣o**, no Objeto **tarefa** (parﾃ｢metro) do Mﾃｩtodo **update(@Body() tarefa: Tarefa)**;

**Linha 36:** Executa o Mﾃｩtodo **update(tarefa: Tarefa)**, **Mﾃｩtodo da Classe TarefaService**, que retornarﾃ｡ **o Objeto da Classe Tarefa** atualizado no Banco de dados. 

3. Apﾃｳs a implementaﾃｧﾃ｣o do Mﾃｩtodo **update(@Body() tarefa: Tarefa)**, observe que a linha 1 do cﾃｳdigo serﾃ｡ atualizada com um novo pacote, como mostra a figura abaixo (indicado em amarelo):

<div align="left"><img src="https://i.imgur.com/7a7wu2Y.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Methods" target="_blank"><b>Documentaﾃｧﾃ｣o: HTTP Request Methods</b></a></div>

<div align="left"><img src="https://i.imgur.com/cDPH4tl.png" title="source: imgur.com" width="30px"/> <a href=" https://developer.mozilla.org/pt-BR/docs/Web/HTTP/Status" target="_blank"><b>Documentaﾃｧﾃ｣o: HTTP Status Code</b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/controllers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Classe Controladora</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/providers" target="_blank"><b>Documentaﾃｧﾃ｣o: <i>Provedores - Classe Controladora</i></b></a></div>

<br />
<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="35px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/07_Cadastrar_Atualizar_Tarefas/todolist/src/tarefa/controllers/tarefa.controller.ts" target="_blank"><b>Cﾃｳdigo fonte da Classe TarefaController</b></a></div>

<br />


<h2>促 Passo 07 - Testar no Insomnia o Mﾃｩtodo update</h2>

Agora vamos criar a Requisiﾃｧﾃ｣o para o **Mﾃｩtodo update(tarefa: Tarefa)**:

1. Clique com o botﾃ｣o direito do mouse sobre a **Pasta Tarefa** para abrir o menu e clique na opﾃｧﾃ｣o **New Request**.

<div align="center"><img src="https://i.imgur.com/6CwyPRd.png?1" title="source: imgur.com" /></div>

2.  Serﾃ｡ criada uma nova Requisiﾃｧﾃ｣o (New Request) dentro da pasta **Tarefa**.

   <div align="center"><img src="https://i.imgur.com/ZRXvMAk.png" title="source: imgur.com" /></div>

3. Dﾃｪ um duplo clique sobre a nova Requisiﾃｧﾃ｣o (**New Request**), informe o nome da Requisiﾃｧﾃ｣o (indicado na imagem abaixo na cor amarela) e pressione a tecla **enter** do seu teclado.

<div align="center"><img src="https://i.imgur.com/LzYHKYB.png" title="source: imgur.com" /></div>

4. Selecione o Mﾃｩtodo HTTP que serﾃ｡ utilizado (**PUT**) na Requisiﾃｧﾃ｣o, indicado na imagem abaixo na cor verde. 

<div align="center"><img src="https://i.imgur.com/z6dWHYj.png" title="source: imgur.com" /></div>

5. No item **Body**, vamos alterar para **JSON**, como mostra a imagem abaixo. Desta forma poderemos enviar os dados do Objeto Tarefa no Corpo da Requisiﾃｧﾃ｣o, no formato JSON.

<div align="center"><img src="https://i.imgur.com/PxOpzFd.png" title="source: imgur.com" /></div>

6. Observe que o item **Body** serﾃ｡ renomeado para **JSON**, como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/8hDNIbh.png" title="source: imgur.com" /></div>

7. Configure o endereﾃｧo da Requisiﾃｧﾃ｣o conforme a imagem abaixo: 

<div align="center"><img src="https://i.imgur.com/JU2LYj1.png" title="source: imgur.com" /></div>

8. No item marcado em amarelo na imagem acima, informe o endereﾃｧo (endpoint) da Requisiﾃｧﾃ｣o. A Requisiﾃｧﾃ｣o **Atualizar Tarefa** foi configurada da seguinte maneira:

   - A primeira parte do endereﾃｧo (http://localhost:4000) ﾃｩ o endereﾃｧo do nosso servidor local. Quando a aplicaﾃｧﾃ｣o estiver na nuvem, ele serﾃ｡ substituﾃｭdo pelo endereﾃｧo da nuvem (**Exemplo:** http://nomedaaplicacao.herokuapp.com).
   - A segunda parte do endereﾃｧo ﾃｩ o **endpoint** configurado no decorator ***@Controller***, em nosso caso **/tarefas**.  
   
5. Na guia **JSON**, precisamos inserir um **JSON** com os dados que serﾃ｣o inseridos na nova tarefa. Lembrando que no padrﾃ｣o JSON: **o texto antes dos 2 pontos** (:) ﾃｩ o **Atributo** da Classe e **o texto depois dos 2 pontos** (:) ﾃｩ o **dado** que serﾃ｡ cadastrado no Atributo.  Os Atributos sﾃ｣o separados por virgula, como mostra a imagem acima.

   | <img src="https://i.imgur.com/hOgWvSc.png" title="source: imgur.com" width="150px"/> | <div align="left"> **ATENﾃﾃグ:** Observe que no Mﾃｩtodo **PUT ﾃｩ necessﾃ｡rio enviar o Atributo id** no JSON para identificar a Tarefa que serﾃ｡ atualizada. </div> |
   | ------------------------------------------------------------ | ------------------------------------------------------------ |

6. Para testar a Requisiﾃｧﾃ｣o, com a aplicaﾃｧﾃ｣o rodando, clique no botﾃ｣o <img src="https://i.imgur.com/sy0V8Nx.png" title="source: imgur.com" width="60px"/>.

7. O resultado da Requisiﾃｧﾃ｣o vocﾃｪ confere na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/zyWKPHU.png" title="source: imgur.com" /></div>

8. Observe que a aplicaﾃｧﾃ｣o retorna alﾃｩm dos dados que foram atualizados no Banco de dados, ela tambﾃｩm retorna um **HTTP Status 200 ｡ｪ OK** (indicado em verde na imagem acima). Este Status indica que a Requisiﾃｧﾃ｣o foi bem sucedida!

9. Caso a Tarefa nﾃ｣o seja encontrada, serﾃ｡ retornado o **HTTP Status 404 ｡ｪ NOT_FOUND**, ou seja, a tarefa nﾃ｣o foi encontrada, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/fV9ab4L.png" title="source: imgur.com" /></div>

10. Caso os Atributos **nome**, **descricao** ou **responsavel** sejam nulos ou em branco (indicado em amarelo), ou no Atributo **nome** seja enviada uma string com mais de 30 caracteres, a aplicaﾃｧﾃ｣o retornarﾃ｡ o **HTTP Status 400 ｡ｪ BAD_REQUEST** (indicado em verde), devido as validaﾃｧﾃｵes que foram inseridas na Classe Tarefa (**@IsNotEmpty** e **@MaxLength(30)**), como mostra a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/P0S9xGa.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/tree/07_Cadastrar_Atualizar_Tarefas" target="_blank"><b>Cﾃｳdigo fonte do projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>