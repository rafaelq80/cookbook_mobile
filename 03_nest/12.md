<h1>Projeto 02 - Todo-List - Relacionamento entre Classes - M√≥dulo Categoria - Parte 01</h1>

O que veremos por aqui:

1. Apresenta√ß√£o do M√≥dulo Categoria
2. Criar o M√≥dulo Categoria
3. Criar a Classe Entidade Categoria
4. Criar a Classe M√≥dulo CategoriaModule
5. Registrar a Classe Categoria na Classe CategoriaModule
6. Registrar a Classe Categoria e CategoriaModule na Classe AppModule
7. Criar o Relacionamento entre as Classes Tarefa e Categoria

<h2>1. O M√≥dulo Categoria</h2>

Nesta etapa vamos come√ßar a construir o M√≥dulo Categoria. Veja o Diagrama de Classes abaixo: 

```mermaid
classDiagram
class Categoria {
  - id : number
  - descricao : String
  - tarefa : List ~Produto~
  + findAll()
  + findById(id : number)
  + findByDescricao(descricao : string)
  + create(categoria : Categoria)
  + update(categoria : Categoria)
  + delete(id : number)
}
```

A **Classe Categoria** servir√° de modelo para construir a tabela **tb_categorias** (Entidade) dentro do nosso Banco de dados **db_todolist**. Os campos (Atributos) da tabela ser√£o os mesmos que est√£o definidos no Diagrama de Classes acima. Al√©m de construirmos a Classe Categoria, tamb√©m faremos o Relacionamento com a Classe Tarefa, constru√≠da anteriormente. 

Na pr√≥xima etapa vamos construir as Classes **CategoriaService e CategoriaController**, que ir√° nos auxiliar na intera√ß√£o com o Banco de dados e onde ser√£o implementados os 6 m√©todos descritos no Diagrama de Classes acima.

Depois de criar a Classe Entidade Categoria, vamos executar o projeto Blog Pessoal. Ap√≥s a execu√ß√£o veremos que ser√° criado no Banco de dados **db_todolist** a tabela **tb_categorias**. Veja abaixo como ficar√° a estrutura da nossa tabela atrav√©s do **Diagrama de Entidade e Relacionamentos (DER)**:

<div align="center"><img src="https://i.imgur.com/IvOXIZE.png" title="source: imgur.com" width="60%"/></div>

O Dicion√°rio de dados da nossa tabela tb_categorias ser√° o seguinte:

| Atributo      | Tipo de dado | Descri√ß√£o           | Chave |
| ------------- | ------------ | ------------------- | ----- |
| **id**        | INT          | Identificador √∫nico | PK    |
| **descricao** | VARCHAR(30)  | Categoria da Tarefa |       |

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o M√≥dulo Categoria. Todas as Classes constru√≠das no M√≥dulo Tarefa dever√£o ser constru√≠das no M√≥dulo Categoria com as adapta√ß√µes pertinentes ao M√≥dulo Categoria.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="80px"/> | <div align="left"> **DICA:** *Caso voc√™ tenha alguma d√∫vida sobre como criar o M√≥dulo, executar o projeto, entre outras, consulte a Documenta√ß√£o do M√≥dulo Tarefa.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<br />

<h2>üë£ Passo 01 - Criar o M√≥dulo Categoria</h2>

Vamos criar o M√≥dulo Categoria:

1. Na pasta **src**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

2. O nome da pasta ser√° **categoria**. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/IaVTfqb.png" title="source: imgur.com" /></div>

Na sequ√™ncia, vamos criar a pasta **entities**, dentro do nosso **M√≥dulo Categoria** (pasta categoria):

1. Na pasta **categoria**, clique com o bot√£o direito do mouse e clique na op√ß√£o **New Folder** (Nova Pasta). 

2. O nome da pasta ser√° **entities**. Ap√≥s digitar o nome da pasta, pressione a tecla **enter** do seu teclado para concluir. 
2. A estrutura de pasta do M√≥dulo Categoria, ficar√° igual a imagem abaixo:

<div align="center"><img src="https://i.imgur.com/y4nuei7.png" title="source: imgur.com" /></div>

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="90px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar a Classe Entidade. Um erro muito comum √© criar a pasta entities fora da pasta do m√≥dulo (categoria).* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<h2>üë£ Passo 02 - Criar a Classe CategoriaModule na pasta Categoria</h2>

Agora vamos criar a Classe **CategoriaModule** que chamaremos de **categoria.module.ts**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe Module. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Clique com o bot√£o direito do mouse sobre a **pasta categoria**, que foi criada dentro da pasta **src** e clique na op√ß√£o **New File** (Novo Arquivo).

2. O nome do arquivo ser√° **categoria.module.ts**. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/8d1NVQ9.png" title="source: imgur.com" /></div>

<h2>üë£ Passo 03 - Criar a Classe Entidade Categoria</h2>

Antes de implementarmos o c√≥digo da Classe **CategoriaModule**, vamos criar a Classe Entidade **Categoria** que chamaremos de **categoria.entity.ts**.

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar Classe Entity. Um erro muito comum √© digitar o nome da Classe de forma incorreta. O nome da Classe deve estar dentro dos padr√µes do Nest para evitar erros na sua aplica√ß√£o.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

1. Clique com o bot√£o direito do mouse sobre a **pasta entities**, que foi criada dentro da pasta **categoria**, e clique na op√ß√£o **New File** (Novo Arquivo).

2. O nome do arquivo ser√° **categoria.entity.ts**. Ap√≥s digitar o nome do arquivo, pressione a tecla **enter** do seu teclado para concluir. 

<div align="center"><img src="https://i.imgur.com/hUs2DXQ.png" title="source: imgur.com" /></div>

Agora vamos criar o c√≥digo da Classe **Categoria**:

```typescript
import { IsNotEmpty, MaxLength } from "class-validator";
import { Column, Entity, PrimaryGeneratedColumn } from "typeorm";

@Entity({name: "tb_categorias"})
export class Categoria {

    @PrimaryGeneratedColumn()    
    id: number

    @IsNotEmpty()
    @MaxLength(30)
    @Column({length: 30, nullable: false})
    descricao: string

}
```

Veja na tabela abaixo a convers√£o de **Tipo de dados TypeScript ü°™ MySQL, de acordo com o que foi definido no Diagrama de Classes acima:**

| Atributo      | Tipo de dado TypeScript | Tipo de dado MySQL |
| ------------- | ----------------------- | ------------------ |
| **id**        | number                  | INT                |
| **descricao** | <i>string</i>           | VARCHAR(30)        |

| <img src="https://i.imgur.com/RfjtOFi.png" title="source: imgur.com" width="100px"/> | <div align="left">**DICA:** *Para relembrar os tipos de dados do TypeScript, <a href="https://www.typescriptlang.org/docs/handbook/2/everyday-types.html">clique aqui</a> e explore os principais tipos de dados oferecidos pelo TypeScript.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

Observe que o c√≥digo √© semelhante ao da Classe Entidade **Tarefa**, do M√≥dulo Tarefa.

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database" target="_blank"><b>Documenta√ß√£o: <i>Banco de dados com Nest</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/entities" target="_blank"><b>Documenta√ß√£o: <i>Entidades no TypeORM</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/6knlnLz.png" title="source: imgur.com" width="30px"/> <a href="https://github.com/typestack/class-validator" target="_blank"><b>Documenta√ß√£o: <i>Pacote Validation</i></b></a></div>

<br />

<h2>üë£ Passo 04 - Registrar a Classe Categoria na Classe CategoriaModule</h2>

Vamos implementar o c√≥digo da Classe **CategoriaModule** e registrar a Classe **Categoria**. Veja abaixo a implementa√ß√£o da Classe **CategoriaModule**:

```typescript
import { Module } from "@nestjs/common";
import { TypeOrmModule } from "@nestjs/typeorm";
import { Categoria } from "./entities/categoria.entity";

@Module({
    imports:[TypeOrmModule.forFeature([Categoria])],
    providers:[],
    controllers:[],
    exports:[TypeOrmModule]
})
export class CategoriaModule { }
```

Observe que o c√≥digo √© semelhante ao da Classe M√≥dulo **TarefaModule**, do M√≥dulo Tarefa.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ATEN√á√ÉO:** *Se uma Classe for importada com o caminho absoluto (src/entities/categoria.entity.ts), os testes da aplica√ß√£o com o framework Jest n√£o ser√£o executados. O Jest n√£o reconhece caminho absoluto, apenas caminho relativo (./entities/categoria.entity.ts)* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/09_Recurso_Categoria_Relacionamento/todolist/src/categoria/categoria.module.ts" target="_blank"><b>C√≥digo fonte da Classe CategoriaModule</b></a></div>

<br />

<h2>üë£ Passo 05 - Registrar as Classes Categoria e CategoriaModule na Classe AppModule</h2>

Para finalizar, vamos registrar a Classe **Tarefa** no M√≥dulo principal da  aplica√ß√£o, a Classe **AppModule**. 

1. Abra a Classe **AppModule**, localizada na pasta **src**, conforme indicada na imagem abaixo:

<div align="center"><img src="https://i.imgur.com/TToXWQF.png" title="source: imgur.com" /></div>

2. Implemente as altera√ß√µes, indicadas pelas setas na imagem abaixo:

<div align="left"><img src="https://i.imgur.com/1EXcjG2.png" title="source: imgur.com" /></div>

Vamos analisar o c√≥digo:

**Linha 3:** Importamos a Classe **CategoriaModule**, criada anteriormente. Observe que na importa√ß√£o da Classe foi utilizado o caminho relativo (**./categoria/categoria.module.ts**) por quest√µes de boas pr√°ticas. 

**Linha 4:** Importamos a Classe **Categoria**, criada anteriormente. Observe que na importa√ß√£o da Classe foi utilizado o caminho relativo (**./categoria/entities/categoria.entity.ts**) por quest√µes de boas pr√°ticas. 

**Linha 17:** No array **entities** vamos inserir todas as **Classes Entidades** do m√≥dulo. Insira no array a Classe **Categoria**, ao lado da Classe Tarefa, separadas por uma virgula.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATEN√á√ÉO:** *Se uma Classe Entidade n√£o for registrada no M√≥dulo principal da aplica√ß√£o (AppModule), a tabela associada a Entidade n√£o ser√° criada no Banco de dados.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

**Linha 21:** No array **imports** vamos inserir o M√≥dulo **CategoriaModule**.  Insira no array a Classe **CategoriaModule**, abaixo da Classe TarefaModule, separadas por uma virgula.

| <img src="https://i.imgur.com/oScAYGc.png" title="source: imgur.com" width="80px"/> | <div align="left"> **ATEN√á√ÉO:** *Se um M√≥dulo n√£o for registrado no M√≥dulo principal da aplica√ß√£o (AppModule), n√£o ser√° poss√≠vel criar um Relacionamento com as Classes Entidades deste M√≥dulo.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/modules" target="_blank"><b>Documenta√ß√£o: <i>M√≥dulos no Nest</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/09_Recurso_Categoria_Relacionamento/todolist/src/app.module.ts" target="_blank"><b>C√≥digo fonte da Classe AppModule</b></a></div>

<br />

<h2>üë£ Passo 06 - Executar o projeto</h2>

1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/kXggbYz.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **todolist**. 

```bash
npm run start:dev
```

3. Se tudo deu certo, o resultado ser√° semelhante ao da figura abaixo:

<div align="center"><img src="https://i.imgur.com/yYhakvx.png" title="source: imgur.com" /></div>

4.Aparentemente n√£o mudou nada, mas vamos checar o Banco de dados...

<br />

<h2>üë£ Passo 07 - Checar o Banco de dados</h2>

1. Abra o **MySQL Workbench** 
1. Verifique se a tabela **tb_categorias** foi criada no Banco de dados **db_todolist**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/Yxo7Z0o.png" title="source: imgur.com" /></div>

<br />
	
<h2>2. Relacionamento entre Classes</h2>

**Mapeamento Objeto-Relacional (ORM)** √© o processo de convers√£o das Classes em Tabelas (Entidades) no Banco de dados da aplica√ß√£o e vice-versa. Em outras palavras, isso nos permite interagir com um Banco de dados Relacional sem utilizar c√≥digo SQL. O **TypeORM** √© um framework que define como persistir dados em aplicativos TypeScript. O foco principal do TypeORM √© a camada ORM. Para mais detalhes, consulte o cookbook <a href="03.md" target="_blank"><b>Introdu√ß√£o ao TypeORM</b></a>.

O **TypeORM** simplifica o tratamento do modelo de Banco de dados Relacional nos aplicativos Nest quando mapeamos cada Tabela para uma √∫nica Classe Entidade (Model). Assim como no MySQL, precisamos criar o Relacionamento entre duas tabelas, no TypeORM tamb√©m precisamos criar o **Relacionamento entre as Classes** e desta forma ele construir√° os Relacionamento entre as duas Tabelas no Banco de dados assim como fizemos no MySQL. 

Nesta etapa vamos construir o Relacionamento do M√≥dulo Categoria com o M√≥dulo Tarefa, a partir das Classes Entidade Categoria e Tarefa. Veja o Diagrama de Classes abaixo: 

<div align="center"><img src="https://i.imgur.com/GX2ksJk.png" title="source: imgur.com" /></div>

Para construirmos o Relacionamento entre Classes, assim como no SQL, precisamos definir a cardinalidade do Relacionamento. Para definir a Cardinalidade, o TypeORM utiliza os decorators abaixo:

| Cardinalidade | Decorator   | Descri√ß√£o                                                    |
| ------------- | ----------- | ------------------------------------------------------------ |
| **1:1**       | @OneToOne   | No relacionamento OneToOne, um Objeto pode pertencer a apenas um outro Objeto, ou seja, √© uma liga√ß√£o um para um. <br />No Banco de dados significa que cada linha de uma Entidade se refere a **<u>apenas</u>** uma linha de outra Entidade. |
| **1:N**       | @OneToMany  | No relacionamento OneToMany,  um Objeto √© referenciado com muitos Objetos.<br/>Em Bancos de dados relacionais, cada linha de uma entidade √© referenciada a muitos registros filhos em outra entidade.<br/>O importante √© que os registros filhos n√£o podem ter v√°rias m√£es. Em  uma rela√ß√£o OneToMany entre a Tabela A e a Tabela B, cada linha da Tabela A est√° ligada a 0, 1 ou muitas linhas da Tabela B.<br/>Numa Rela√ß√£o Unidirecional, a rela√ß√£o ser√° uma rela√ß√£o OneToMany porqu√™ o lado Um da rela√ß√£o manda no Relacionamento. |
| **N:1**       | @ManyToOne  | No relacionamento  ManyToOne,  um Objeto √© referenciado com outro Objeto que cont√©m valores √∫nicos.<br/>Em Bancos de dados Relacionais, esses relacionamentos s√£o aplic√°veis usando o par Chave Estrangeira (Lado N da Rela√ß√£o) e a  Chave Prim√°ria (Lado 1 da Rela√ß√£o), entre as tabelas. O Lado N tamb√©m deve ter uma Chave Prim√°ria.<br />Numa Rela√ß√£o Bidirecional, essa anota√ß√£o ser√° utilizada para referenciar o Lado Um da Rela√ß√£o, atrav√©s de um Objeto, que funcionar√° como a Chave Estrangeira. |
| **N:M**       | @ManyToMany | No relacionamento ManyToMany,  muitos Objetos s√£o referenciados com muitos outros Objetos.<br/>Em Bancos de dados Relacionais, o relacionamento Muitos para Muitos uma ou mais linhas de uma Entidade s√£o associadas a mais de uma linha em outra Entidade.<br />Os relacionamentos ManyToMany exigem um pouco mais de trabalho do que os outros relacionamentos.<br />Em um Banco de dados, um Relacionamento ManyToMany envolve uma terceira Tabela intermedi√°ria, que faz refer√™ncia a ambas as outras tabelas armazenando as 2 Chaves estrangeiras. |

No modelo Relacional, 1:N e N:1 s√£o a mesma coisa, entretanto no Relacionamento de Classes, al√©m da Cardinalidade √© necess√°rio definir a Dire√ß√£o do Relacionamento, ou seja, Se apenas a Classe M√£e exibe a Classe Filha (Unidirecional) ou se Classe Filha tamb√©m Exibir√° a Classe M√£e (Bidirecional), ao listar os dados em uma consulta.

No Modelo Relacional todo Relacionamento √© **Unidirecional**, ou seja, **apenas a Tabela que possui a Chave Estrangeira acessa a outra Tabela**. No Relacionamento de Classes, existe a possibilidade do Relacionamento ser **Bidirecional**, ou seja, uma **Classe acessa a outra e vice-versa, independente de possuir ou n√£o a Chave Estrangeira**.

Depois de criar o Relacionamento entre as Classes e executar o projeto Blog Pessoal no STS, veremos que ser√° criado no MySQL a Rela√ß√£o entre as tabelas **tb_tarefas** e **tb_categorias** Unidirecional. Veja abaixo como ficar√° a estrutura da nossa tabela atrav√©s do **Diagrama de Entidade e Relacionamentos (DER)**:

<div align="center"><img src="https://i.imgur.com/bVnuhkf.png" title="source: imgur.com" /></div>

Como o TypeORM faz o mapeamento das Tabelas em Objetos, caso o Relacionamento Bidirecional esteja habilitado, a Rela√ß√£o funcionar√° independente do Banco de Dados ser Unidirecional.

Vamos construir o Relacionamento Bidirecional (1:N) entre as nossas Classes Categoria e Tarefa como veremos a seguir. 

<br />

<h2>üë£ Passo 01 - Criar a Rela√ß√£o ManytoOne na Classe Tarefa</h2>

A Classe Tarefa ser√° o lado N:1, ou seja, **Muitas Tarefas podem ter apenas Uma Categoria**. Para criar a Rela√ß√£o vamos inserir depois do √∫ltimo atributo da Classe Tarefa (status), as linhas destacadas em amarelo na figura abaixo:

<div align="left"><img src="https://i.imgur.com/6yL493S.png" title="source: imgur.com" /></div>

**Linha 30:** O decorator **@ManyToOne** indica que a Classe Tarefa ser√° o lado N:1 da rela√ß√£o e ter√° um **Objeto da Classe Categoria**, chamado **categoria**, que no modelo Relacional ser√° a **Chave Estrangeira na Tabela tb_tarefas (categoriaId)**.

**Linha 31:** Os relacionamentos entre entidades geralmente dependem da exist√™ncia de outra entidade, por exemplo, o relacionamento **Categoria ü°™ Tarefa**. Sem o Categoria, a entidade Tarefa n√£o tem nenhum significado pr√≥prio. Quando exclu√≠mos a entidade Categoria, as entidades Tarefa associadas tamb√©m devem ser exclu√≠das. **"Cascatear" (cascade)**, √© a maneira de conseguir isso. Quando executamos alguma a√ß√£o na entidade de destino (Categoria), a mesma a√ß√£o ser√° aplicada √† entidade associada (Tarefa). 

- **onDelete:** O "cascateamento" foi habilitado apenas na opera√ß√£o Delete, ou seja, apenas quando um Objeto da Classe Categoria for apagado, todos os Objetos da Classe Tarefa associados ao Categoria apagado, tamb√©m ser√£o apagados. O Inverso n√£o √© verdadeiro. As demais opera√ß√µes do CRUD n√£o ser√£o cascateadas.

Al√©m de habilitar no delete, √© poss√≠vel habilitar o cascade na atualiza√ß√£o de dados, atrav√©s da op√ß√£o **OnUpdate**. No projeto Blog Pessoal, n√£o √© necess√°rio habilitar esta op√ß√£o.

**Linha 33:** Ser√° criado um Objeto da Classe Categoria, que receber√° os dados do Categoria associado ao Objeto da Classe Tarefa. Este Objeto representa a Chave Estrangeira da Tabela **tb_tarefas (categoriaid)**.

Veja abaixo o c√≥digo completo da **Classe Entidade Tarefa**:

```typescript
import { IsNotEmpty, MaxLength } from "class-validator"
import { Column, Entity, ManyToOne, PrimaryGeneratedColumn } from "typeorm"
import { Categoria } from "../../categoria/entities/categoria.entity"

@Entity({name: "tb_tarefas"})
export class Tarefa {

    @PrimaryGeneratedColumn()    
    id: number

    @IsNotEmpty()
    @MaxLength(30)
    @Column({length: 30, nullable: false})
    nome: string

    @IsNotEmpty()
    @Column({length: 5000, nullable: false})
    descricao: string

    @IsNotEmpty()
    @Column({length: 5000, nullable: false})
    responsavel: string
    
    @Column()
    data: Date

    @Column()
    status: boolean

    @ManyToOne(() => Categoria, (categoria) => categoria.tarefas, {
        onDelete: "CASCADE"
    })
    categoria: Categoria

}
```

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o Relacionamento entre as Classes. Observe que ap√≥s habilitar o Relacionamento entre Classes, novas importa√ß√µes de Classes ser√£o necess√°rias nas primeiras linhas da Classe Tarefa.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database#relations" target="_blank"><b>Documenta√ß√£o: <i>Relacionamento entre Classes</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/many-to-one-one-to-many-relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos One to Many e Many to One</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/09_Recurso_Categoria_Relacionamento/todolist/src/tarefa/entities/tarefa.entity.ts" target="_blank"><b>C√≥digo fonte da Classe Tarefa</b></a>
<br /></div>


<br />

<h2>üë£ Passo 02 - Criar a Rela√ß√£o OneToMany na Classe Categoria</h2>

A Classe Categoria ser√° o lado 1:N, ou seja, **Uma Categoria pode ter Muitas Tarefas**. Para criar a Rela√ß√£o vamos inserir depois do √∫ltimo atributo da Classe Categoria (descricao), o trecho de c√≥digo destacado em amarelo na figura abaixo:

<div align="left"><img src="https://i.imgur.com/gfWP8nW.png" title="source: imgur.com" /></div>

**Linha 16:** O decorator **@OneToMany** indica que a Classe Categoria ser√° o lado 1:N da rela√ß√£o e ter√° um **array de Objetos da Classe Tarefa**, chamado **tarefa**, para listar todas as tarefas associadas a cada categoria.

**Linha 17:** Ser√° criado um array de Objetos da Classe Tarefa, que receber√° os dados das tarefas associadas a cada Objeto da Classe Categoria.

Veja abaixo o c√≥digo completo da **Classe Entidade Tarefa**:

```typescript
import { IsNotEmpty, MaxLength } from "class-validator";
import { Column, Entity, OneToMany, PrimaryGeneratedColumn } from "typeorm";
import { Tarefa } from "../../tarefa/entities/tarefa.entity";

@Entity({name: "tb_categorias"})
export class Categoria {

    @PrimaryGeneratedColumn()    
    id: number

    @IsNotEmpty()
    @MaxLength(30)
    @Column({length: 30, nullable: false})
    descricao: string

    @OneToMany(() => Tarefa, (tarefa) => tarefa.categoria)
    tarefas: Tarefa[] 
    
}
```

| <img src="https://i.imgur.com/vVDBDG0.png" title="source: imgur.com" width="100px"/> | <div align="left"> **ALERTA DE BSM:** *Mantenha a Aten√ß√£o aos Detalhes ao criar o Relacionamento entre as Classes. Observe que ap√≥s habilitar o Relacionamento entre Classes, novas importa√ß√µes de Classes ser√£o necess√°rias nas primeiras linhas da Classe Categoria.* </div> |
| ------------------------------------------------------------ | ------------------------------------------------------------ |

<div align="left"><img src="https://i.imgur.com/O6PILGE.png" title="source: imgur.com" width="25px"/> <a href="https://docs.nestjs.com/techniques/database#relations" target="_blank"><b>Documenta√ß√£o: <i>Relacionamento entre Classes</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos</i></b></a></div>

<div align="left"><img src="https://i.imgur.com/OtnA0bd.png" title="source: imgur.com" width="25px"/> <a href="https://typeorm.io/many-to-one-one-to-many-relations" target="_blank"><b>Documenta√ß√£o: <i>TypeORM - Relacionamentos One to Many e Many to One</i></b></a></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/blob/09_Recurso_Categoria_Relacionamento/todolist/src/categoria/entities/categoria.entity.ts" target="_blank"><b>C√≥digo fonte da Classe Categoria</b></a></div>

<br />

<h2>üë£ Passo 03 - Executar o projeto</h2>

1. Verifique se voc√™ est√° dentro da pasta do projeto, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/kXggbYz.png" title="source: imgur.com" /></div>

2. Digite o comando ***npm run start:dev***, para compilar e executar o nosso projeto **todolist**, caso n√£o esteja em execu√ß√£o. 

```bash
npm run start:dev
```

3. Se tudo deu certo, o resultado ser√° semelhante ao da figura abaixo:

<div align="center"><img src="https://i.imgur.com/yYhakvx.png" title="source: imgur.com" /></div>

4.Aparentemente n√£o mudou nada, mas vamos checar o Banco de dados...

<br />

<h2>üë£ Passo 04 - Checar o Banco de dados</h2>

1. Abra o **MySQL Workbench** 
1. Verifique se a **Chave Estrangeira (categoriaId)** foi criada na Tabela **tb_tarefas**, no Banco de dados **db_todolist**, como mostra a figura abaixo:

<div align="center"><img src="https://i.imgur.com/ia8WkHr.png" title="source: imgur.com" /></div>

<br />

<div align="left"><img src="https://i.imgur.com/bQGvf3h.png" title="source: imgur.com" width="25px"/> <a href="https://github.com/rafaelq80/backend_todolist_nest/tree/09_Recurso_Categoria_Relacionamento" target="_blank"><b>C√≥digo fonte do Projeto</b></a></div>

<br /><br />

<div align="left"><a href="README.md"><img src="https://i.imgur.com/XMgF3gl.png" title="source: imgur.com" width="3%"/>Voltar</a></div>